Not using distributed mode
Namespace(batch_size=64, epochs=20, bce_loss=False, unscale_lr=False, model='deit_tiny_patch16_224', input_size=224, drop=0.0, drop_path=0.1, model_ema=True, model_ema_decay=0.99996, model_ema_force_cpu=False, opt='adamw', opt_eps=1e-08, opt_betas=None, clip_grad=None, momentum=0.9, weight_decay=0.05, sched='cosine', lr=0.0005, lr_noise=None, lr_noise_pct=0.67, lr_noise_std=1.0, warmup_lr=1e-06, min_lr=1e-05, decay_epochs=30, warmup_epochs=5, cooldown_epochs=10, patience_epochs=10, decay_rate=0.1, color_jitter=0.3, aa='rand-m9-mstd0.5-inc1', smoothing=0.1, train_interpolation='bicubic', repeated_aug=True, train_mode=True, ThreeAugment=False, src=False, reprob=0.25, remode='pixel', recount=1, resplit=False, mixup=0.8, cutmix=1.0, cutmix_minmax=None, mixup_prob=1.0, mixup_switch_prob=0.5, mixup_mode='batch', teacher_model='regnety_160', teacher_path='', distillation_type='none', distillation_alpha=0.5, distillation_tau=1.0, cosub=False, finetune='https://dl.fbaipublicfiles.com/deit/deit_tiny_patch16_224-a1311bcf.pth', attn_only=False, data_path='/home/shared_data/salmonella_detection/OriginalData/AmericanData', data_set='Smh_custom', inat_category='name', output_dir='/home/shared_data/salmonella_detection/smh_shared_output/exp_name', device='cuda', seed=0, resume='', start_epoch=0, eval=False, eval_crop_ratio=0.875, dist_eval=False, num_workers=0, pin_mem=True, distributed=False, world_size=1, dist_url='env://', logger=True, exp_name='first_try', val_ratio=0.3)
Creating model: deit_tiny_patch16_224
Removing key head.weight from pretrained checkpoint
Removing key head.bias from pretrained checkpoint
number of params: 5524802
/home/qingchan/micromamba/envs/smh_dect/lib/python3.12/site-packages/timm/utils/cuda.py:50: FutureWarning: `torch.cuda.amp.GradScaler(args...)` is deprecated. Please use `torch.amp.GradScaler('cuda', args...)` instead.
  self._scaler = torch.cuda.amp.GradScaler()
Start training for 20 epochs
/home/qingchan/project/deit_smh/deit_smh/engine.py:86: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast():
Epoch: [0]  [0/7]  eta: 0:00:12  lr: 0.000001  loss: 0.6816 (0.6816)  time: 1.7182  data: 1.2288  max mem: 1186
Epoch: [0]  [6/7]  eta: 0:00:01  lr: 0.000001  loss: 0.6935 (0.7003)  time: 1.2897  data: 1.1913  max mem: 1229
Epoch: [0] Total time: 0:00:09 (1.2899 s / it)
Averaged stats: lr: 0.000001  loss: 0.6935 (0.7003)
/home/qingchan/project/deit_smh/deit_smh/engine.py:137: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast():
Test:  [0/3]  eta: 0:00:06  loss: 0.6921 (0.6921)  acc1: 61.4583 (61.4583)  acc5: 100.0000 (100.0000)  time: 2.1605  data: 2.1118  max mem: 1229
Test:  [2/3]  eta: 0:00:01  loss: 0.6921 (0.6922)  acc1: 53.1250 (55.6075)  acc5: 100.0000 (100.0000)  time: 1.6319  data: 1.6057  max mem: 1229
Test: Total time: 0:00:04 (1.6323 s / it)
* Acc@1 55.607 Acc@5 100.000 loss 0.692
Accuracy of the network on the 214 test images: 55.6%
Max accuracy: 55.61%
/home/qingchan/project/deit_smh/deit_smh/engine.py:86: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast():
Epoch: [1]  [0/7]  eta: 0:00:08  lr: 0.000001  loss: 0.7416 (0.7416)  time: 1.1894  data: 1.1540  max mem: 1229
Epoch: [1]  [6/7]  eta: 0:00:01  lr: 0.000001  loss: 0.7186 (0.7092)  time: 1.1428  data: 1.1094  max mem: 1229
Epoch: [1] Total time: 0:00:08 (1.1429 s / it)
Averaged stats: lr: 0.000001  loss: 0.7186 (0.7092)
/home/qingchan/project/deit_smh/deit_smh/engine.py:137: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast():
Test:  [0/3]  eta: 0:00:06  loss: 0.6917 (0.6917)  acc1: 59.3750 (59.3750)  acc5: 100.0000 (100.0000)  time: 2.2634  data: 2.2503  max mem: 1229
Test:  [2/3]  eta: 0:00:01  loss: 0.6917 (0.6901)  acc1: 54.1667 (55.6075)  acc5: 100.0000 (100.0000)  time: 1.6432  data: 1.6331  max mem: 1229
Test: Total time: 0:00:04 (1.6435 s / it)
* Acc@1 55.607 Acc@5 100.000 loss 0.690
Accuracy of the network on the 214 test images: 55.6%
Max accuracy: 55.61%
/home/qingchan/project/deit_smh/deit_smh/engine.py:86: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast():
Epoch: [2]  [0/7]  eta: 0:00:07  lr: 0.000013  loss: 0.6867 (0.6867)  time: 1.0179  data: 0.9855  max mem: 1229
Epoch: [2]  [6/7]  eta: 0:00:01  lr: 0.000013  loss: 0.7009 (0.7021)  time: 1.0277  data: 0.9938  max mem: 1229
Epoch: [2] Total time: 0:00:07 (1.0278 s / it)
Averaged stats: lr: 0.000013  loss: 0.7009 (0.7021)
/home/qingchan/project/deit_smh/deit_smh/engine.py:137: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast():
Test:  [0/3]  eta: 0:00:06  loss: 0.7044 (0.7044)  acc1: 55.2083 (55.2083)  acc5: 100.0000 (100.0000)  time: 2.0163  data: 2.0032  max mem: 1229
Test:  [2/3]  eta: 0:00:01  loss: 0.6823 (0.6848)  acc1: 59.0909 (60.7477)  acc5: 100.0000 (100.0000)  time: 1.5518  data: 1.5414  max mem: 1229
Test: Total time: 0:00:04 (1.5522 s / it)
* Acc@1 60.748 Acc@5 100.000 loss 0.685
Accuracy of the network on the 214 test images: 60.7%
Max accuracy: 60.75%
/home/qingchan/project/deit_smh/deit_smh/engine.py:86: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast():
Epoch: [3]  [0/7]  eta: 0:00:08  lr: 0.000026  loss: 0.6880 (0.6880)  time: 1.1667  data: 1.1325  max mem: 1229
Epoch: [3]  [6/7]  eta: 0:00:01  lr: 0.000026  loss: 0.6880 (0.6753)  time: 1.0831  data: 1.0500  max mem: 1229
Epoch: [3] Total time: 0:00:07 (1.0832 s / it)
Averaged stats: lr: 0.000026  loss: 0.6880 (0.6753)
/home/qingchan/project/deit_smh/deit_smh/engine.py:137: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast():
Test:  [0/3]  eta: 0:00:06  loss: 0.6829 (0.6829)  acc1: 55.2083 (55.2083)  acc5: 100.0000 (100.0000)  time: 2.0971  data: 2.0840  max mem: 1229
Test:  [2/3]  eta: 0:00:01  loss: 0.6612 (0.6680)  acc1: 63.6364 (60.2804)  acc5: 100.0000 (100.0000)  time: 1.5549  data: 1.5449  max mem: 1229
Test: Total time: 0:00:04 (1.5552 s / it)
* Acc@1 60.280 Acc@5 100.000 loss 0.668
Accuracy of the network on the 214 test images: 60.3%
Max accuracy: 60.75%
/home/qingchan/project/deit_smh/deit_smh/engine.py:86: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast():
Epoch: [4]  [0/7]  eta: 0:00:07  lr: 0.000038  loss: 0.6688 (0.6688)  time: 1.0560  data: 1.0237  max mem: 1229
Epoch: [4]  [6/7]  eta: 0:00:01  lr: 0.000038  loss: 0.6746 (0.6729)  time: 1.0423  data: 1.0090  max mem: 1229
Epoch: [4] Total time: 0:00:07 (1.0424 s / it)
Averaged stats: lr: 0.000038  loss: 0.6746 (0.6729)
/home/qingchan/project/deit_smh/deit_smh/engine.py:137: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast():
Test:  [0/3]  eta: 0:00:06  loss: 0.6751 (0.6751)  acc1: 58.3333 (58.3333)  acc5: 100.0000 (100.0000)  time: 2.0013  data: 1.9881  max mem: 1229
Test:  [2/3]  eta: 0:00:01  loss: 0.6751 (0.6695)  acc1: 58.3333 (58.4112)  acc5: 100.0000 (100.0000)  time: 1.4998  data: 1.4897  max mem: 1229
Test: Total time: 0:00:04 (1.5001 s / it)
* Acc@1 58.411 Acc@5 100.000 loss 0.670
Accuracy of the network on the 214 test images: 58.4%
Max accuracy: 60.75%
/home/qingchan/project/deit_smh/deit_smh/engine.py:86: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast():
Epoch: [5]  [0/7]  eta: 0:00:07  lr: 0.000050  loss: 0.6709 (0.6709)  time: 1.0360  data: 1.0035  max mem: 1229
Epoch: [5]  [6/7]  eta: 0:00:01  lr: 0.000050  loss: 0.6709 (0.6816)  time: 1.0303  data: 0.9967  max mem: 1229
Epoch: [5] Total time: 0:00:07 (1.0304 s / it)
Averaged stats: lr: 0.000050  loss: 0.6709 (0.6816)
/home/qingchan/project/deit_smh/deit_smh/engine.py:137: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast():
Test:  [0/3]  eta: 0:00:05  loss: 0.6800 (0.6800)  acc1: 55.2083 (55.2083)  acc5: 100.0000 (100.0000)  time: 1.9892  data: 1.9760  max mem: 1229
Test:  [2/3]  eta: 0:00:01  loss: 0.6545 (0.6559)  acc1: 59.0909 (59.8131)  acc5: 100.0000 (100.0000)  time: 1.4858  data: 1.4757  max mem: 1229
Test: Total time: 0:00:04 (1.4862 s / it)
* Acc@1 59.813 Acc@5 100.000 loss 0.656
Accuracy of the network on the 214 test images: 59.8%
Max accuracy: 60.75%
/home/qingchan/project/deit_smh/deit_smh/engine.py:86: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast():
Epoch: [6]  [0/7]  eta: 0:00:06  lr: 0.000055  loss: 0.6600 (0.6600)  time: 0.9917  data: 0.9585  max mem: 1229
Epoch: [6]  [6/7]  eta: 0:00:01  lr: 0.000055  loss: 0.6708 (0.6679)  time: 1.0302  data: 0.9970  max mem: 1229
Epoch: [6] Total time: 0:00:07 (1.0303 s / it)
Averaged stats: lr: 0.000055  loss: 0.6708 (0.6679)
/home/qingchan/project/deit_smh/deit_smh/engine.py:137: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast():
Test:  [0/3]  eta: 0:00:06  loss: 0.6831 (0.6831)  acc1: 58.3333 (58.3333)  acc5: 100.0000 (100.0000)  time: 2.0095  data: 1.9963  max mem: 1229
Test:  [2/3]  eta: 0:00:01  loss: 0.6707 (0.6577)  acc1: 58.3333 (59.3458)  acc5: 100.0000 (100.0000)  time: 1.5028  data: 1.4924  max mem: 1229
Test: Total time: 0:00:04 (1.5032 s / it)
* Acc@1 59.346 Acc@5 100.000 loss 0.658
Accuracy of the network on the 214 test images: 59.3%
Max accuracy: 60.75%
/home/qingchan/project/deit_smh/deit_smh/engine.py:86: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast():
Epoch: [7]  [0/7]  eta: 0:00:07  lr: 0.000052  loss: 0.6953 (0.6953)  time: 1.0135  data: 0.9815  max mem: 1229
Epoch: [7]  [6/7]  eta: 0:00:01  lr: 0.000052  loss: 0.6583 (0.6692)  time: 1.0305  data: 0.9973  max mem: 1229
Epoch: [7] Total time: 0:00:07 (1.0306 s / it)
Averaged stats: lr: 0.000052  loss: 0.6583 (0.6692)
/home/qingchan/project/deit_smh/deit_smh/engine.py:137: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast():
Test:  [0/3]  eta: 0:00:06  loss: 0.6925 (0.6925)  acc1: 57.2917 (57.2917)  acc5: 100.0000 (100.0000)  time: 2.0967  data: 2.0835  max mem: 1229
Test:  [2/3]  eta: 0:00:01  loss: 0.6437 (0.6493)  acc1: 63.5417 (62.6168)  acc5: 100.0000 (100.0000)  time: 1.5473  data: 1.5372  max mem: 1229
Test: Total time: 0:00:04 (1.5477 s / it)
* Acc@1 62.617 Acc@5 100.000 loss 0.649
Accuracy of the network on the 214 test images: 62.6%
Max accuracy: 62.62%
/home/qingchan/project/deit_smh/deit_smh/engine.py:86: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast():
Epoch: [8]  [0/7]  eta: 0:00:07  lr: 0.000048  loss: 0.6439 (0.6439)  time: 1.0362  data: 1.0038  max mem: 1229
Epoch: [8]  [6/7]  eta: 0:00:01  lr: 0.000048  loss: 0.6493 (0.6628)  time: 1.0339  data: 1.0006  max mem: 1229
Epoch: [8] Total time: 0:00:07 (1.0341 s / it)
Averaged stats: lr: 0.000048  loss: 0.6493 (0.6628)
/home/qingchan/project/deit_smh/deit_smh/engine.py:137: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast():
Test:  [0/3]  eta: 0:00:06  loss: 0.6872 (0.6872)  acc1: 59.3750 (59.3750)  acc5: 100.0000 (100.0000)  time: 2.0155  data: 2.0023  max mem: 1229
Test:  [2/3]  eta: 0:00:01  loss: 0.6581 (0.6451)  acc1: 59.3750 (61.6822)  acc5: 100.0000 (100.0000)  time: 1.5059  data: 1.4958  max mem: 1229
Test: Total time: 0:00:04 (1.5062 s / it)
* Acc@1 61.682 Acc@5 100.000 loss 0.645
Accuracy of the network on the 214 test images: 61.7%
Max accuracy: 62.62%
/home/qingchan/project/deit_smh/deit_smh/engine.py:86: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast():
Epoch: [9]  [0/7]  eta: 0:00:07  lr: 0.000044  loss: 0.6974 (0.6974)  time: 1.0200  data: 0.9876  max mem: 1229
Epoch: [9]  [6/7]  eta: 0:00:01  lr: 0.000044  loss: 0.6544 (0.6593)  time: 1.0441  data: 1.0108  max mem: 1229
Epoch: [9] Total time: 0:00:07 (1.0442 s / it)
Averaged stats: lr: 0.000044  loss: 0.6544 (0.6593)
/home/qingchan/project/deit_smh/deit_smh/engine.py:137: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast():
Test:  [0/3]  eta: 0:00:06  loss: 0.6880 (0.6880)  acc1: 58.3333 (58.3333)  acc5: 100.0000 (100.0000)  time: 2.0828  data: 2.0698  max mem: 1229
Test:  [2/3]  eta: 0:00:01  loss: 0.6533 (0.6428)  acc1: 62.5000 (62.6168)  acc5: 100.0000 (100.0000)  time: 1.5599  data: 1.5497  max mem: 1229
Test: Total time: 0:00:04 (1.5603 s / it)
* Acc@1 62.617 Acc@5 100.000 loss 0.643
Accuracy of the network on the 214 test images: 62.6%
Max accuracy: 62.62%
/home/qingchan/project/deit_smh/deit_smh/engine.py:86: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast():
Epoch: [10]  [0/7]  eta: 0:00:07  lr: 0.000040  loss: 0.6761 (0.6761)  time: 1.0322  data: 0.9985  max mem: 1229
Epoch: [10]  [6/7]  eta: 0:00:01  lr: 0.000040  loss: 0.6515 (0.6546)  time: 1.0366  data: 1.0026  max mem: 1229
Epoch: [10] Total time: 0:00:07 (1.0368 s / it)
Averaged stats: lr: 0.000040  loss: 0.6515 (0.6546)
/home/qingchan/project/deit_smh/deit_smh/engine.py:137: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast():
Test:  [0/3]  eta: 0:00:06  loss: 0.6885 (0.6885)  acc1: 56.2500 (56.2500)  acc5: 100.0000 (100.0000)  time: 2.2121  data: 2.1990  max mem: 1229
Test:  [2/3]  eta: 0:00:01  loss: 0.6456 (0.6408)  acc1: 64.5833 (61.6822)  acc5: 100.0000 (100.0000)  time: 1.5898  data: 1.5797  max mem: 1229
Test: Total time: 0:00:04 (1.5902 s / it)
* Acc@1 61.682 Acc@5 100.000 loss 0.641
Accuracy of the network on the 214 test images: 61.7%
Max accuracy: 62.62%
/home/qingchan/project/deit_smh/deit_smh/engine.py:86: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast():
Epoch: [11]  [0/7]  eta: 0:00:07  lr: 0.000036  loss: 0.6392 (0.6392)  time: 1.0218  data: 0.9897  max mem: 1229
Epoch: [11]  [6/7]  eta: 0:00:01  lr: 0.000036  loss: 0.6716 (0.6622)  time: 1.0491  data: 1.0159  max mem: 1229
Epoch: [11] Total time: 0:00:07 (1.0492 s / it)
Averaged stats: lr: 0.000036  loss: 0.6716 (0.6622)
/home/qingchan/project/deit_smh/deit_smh/engine.py:137: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast():
Test:  [0/3]  eta: 0:00:06  loss: 0.6858 (0.6858)  acc1: 58.3333 (58.3333)  acc5: 100.0000 (100.0000)  time: 2.0164  data: 2.0033  max mem: 1229
Test:  [2/3]  eta: 0:00:01  loss: 0.6588 (0.6444)  acc1: 61.4583 (61.6822)  acc5: 100.0000 (100.0000)  time: 1.5120  data: 1.5018  max mem: 1229
Test: Total time: 0:00:04 (1.5124 s / it)
* Acc@1 61.682 Acc@5 100.000 loss 0.644
Accuracy of the network on the 214 test images: 61.7%
Max accuracy: 62.62%
/home/qingchan/project/deit_smh/deit_smh/engine.py:86: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast():
Epoch: [12]  [0/7]  eta: 0:00:07  lr: 0.000032  loss: 0.5992 (0.5992)  time: 1.0434  data: 1.0095  max mem: 1229
Epoch: [12]  [6/7]  eta: 0:00:01  lr: 0.000032  loss: 0.6459 (0.6604)  time: 1.0191  data: 0.9857  max mem: 1229
Epoch: [12] Total time: 0:00:07 (1.0192 s / it)
Averaged stats: lr: 0.000032  loss: 0.6459 (0.6604)
/home/qingchan/project/deit_smh/deit_smh/engine.py:137: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast():
Test:  [0/3]  eta: 0:00:05  loss: 0.6917 (0.6917)  acc1: 59.3750 (59.3750)  acc5: 100.0000 (100.0000)  time: 1.9871  data: 1.9740  max mem: 1229
Test:  [2/3]  eta: 0:00:01  loss: 0.6817 (0.6530)  acc1: 60.4167 (61.6822)  acc5: 100.0000 (100.0000)  time: 1.5216  data: 1.5116  max mem: 1229
Test: Total time: 0:00:04 (1.5220 s / it)
* Acc@1 61.682 Acc@5 100.000 loss 0.653
Accuracy of the network on the 214 test images: 61.7%
Max accuracy: 62.62%
/home/qingchan/project/deit_smh/deit_smh/engine.py:86: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast():
Epoch: [13]  [0/7]  eta: 0:00:07  lr: 0.000028  loss: 0.6761 (0.6761)  time: 1.0289  data: 0.9948  max mem: 1229
Epoch: [13]  [6/7]  eta: 0:00:01  lr: 0.000028  loss: 0.6566 (0.6549)  time: 1.0460  data: 1.0127  max mem: 1229
Epoch: [13] Total time: 0:00:07 (1.0461 s / it)
Averaged stats: lr: 0.000028  loss: 0.6566 (0.6549)
/home/qingchan/project/deit_smh/deit_smh/engine.py:137: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast():
Test:  [0/3]  eta: 0:00:06  loss: 0.6879 (0.6879)  acc1: 60.4167 (60.4167)  acc5: 100.0000 (100.0000)  time: 2.0686  data: 2.0536  max mem: 1229
Test:  [2/3]  eta: 0:00:01  loss: 0.6600 (0.6416)  acc1: 61.4583 (62.6168)  acc5: 100.0000 (100.0000)  time: 1.5311  data: 1.5204  max mem: 1229
Test: Total time: 0:00:04 (1.5315 s / it)
* Acc@1 62.617 Acc@5 100.000 loss 0.642
Accuracy of the network on the 214 test images: 62.6%
Max accuracy: 62.62%
/home/qingchan/project/deit_smh/deit_smh/engine.py:86: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast():
Epoch: [14]  [0/7]  eta: 0:00:07  lr: 0.000024  loss: 0.5901 (0.5901)  time: 1.0463  data: 1.0139  max mem: 1229
Epoch: [14]  [6/7]  eta: 0:00:01  lr: 0.000024  loss: 0.6774 (0.6525)  time: 1.0185  data: 0.9853  max mem: 1229
Epoch: [14] Total time: 0:00:07 (1.0186 s / it)
Averaged stats: lr: 0.000024  loss: 0.6774 (0.6525)
/home/qingchan/project/deit_smh/deit_smh/engine.py:137: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast():
Test:  [0/3]  eta: 0:00:06  loss: 0.6884 (0.6884)  acc1: 57.2917 (57.2917)  acc5: 100.0000 (100.0000)  time: 2.0604  data: 2.0474  max mem: 1229
Test:  [2/3]  eta: 0:00:01  loss: 0.6723 (0.6465)  acc1: 58.3333 (58.8785)  acc5: 100.0000 (100.0000)  time: 1.4998  data: 1.4897  max mem: 1229
Test: Total time: 0:00:04 (1.5001 s / it)
* Acc@1 58.879 Acc@5 100.000 loss 0.646
Accuracy of the network on the 214 test images: 58.9%
Max accuracy: 62.62%
/home/qingchan/project/deit_smh/deit_smh/engine.py:86: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast():
Epoch: [15]  [0/7]  eta: 0:00:07  lr: 0.000021  loss: 0.6377 (0.6377)  time: 1.0094  data: 0.9762  max mem: 1229
Epoch: [15]  [6/7]  eta: 0:00:00  lr: 0.000021  loss: 0.6502 (0.6512)  time: 0.9914  data: 0.9579  max mem: 1229
Epoch: [15] Total time: 0:00:06 (0.9915 s / it)
Averaged stats: lr: 0.000021  loss: 0.6502 (0.6512)
/home/qingchan/project/deit_smh/deit_smh/engine.py:137: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast():
Test:  [0/3]  eta: 0:00:06  loss: 0.6892 (0.6892)  acc1: 59.3750 (59.3750)  acc5: 100.0000 (100.0000)  time: 2.0820  data: 2.0689  max mem: 1229
Test:  [2/3]  eta: 0:00:01  loss: 0.6817 (0.6499)  acc1: 59.3750 (59.3458)  acc5: 100.0000 (100.0000)  time: 1.5558  data: 1.5456  max mem: 1229
Test: Total time: 0:00:04 (1.5562 s / it)
* Acc@1 59.346 Acc@5 100.000 loss 0.650
Accuracy of the network on the 214 test images: 59.3%
Max accuracy: 62.62%
/home/qingchan/project/deit_smh/deit_smh/engine.py:86: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast():
Epoch: [16]  [0/7]  eta: 0:00:07  lr: 0.000018  loss: 0.6491 (0.6491)  time: 1.0694  data: 1.0369  max mem: 1229
Epoch: [16]  [6/7]  eta: 0:00:01  lr: 0.000018  loss: 0.6472 (0.6581)  time: 1.0314  data: 0.9982  max mem: 1229
Epoch: [16] Total time: 0:00:07 (1.0315 s / it)
Averaged stats: lr: 0.000018  loss: 0.6472 (0.6581)
/home/qingchan/project/deit_smh/deit_smh/engine.py:137: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast():
Test:  [0/3]  eta: 0:00:06  loss: 0.6872 (0.6872)  acc1: 58.3333 (58.3333)  acc5: 100.0000 (100.0000)  time: 2.0926  data: 2.0776  max mem: 1229
Test:  [2/3]  eta: 0:00:01  loss: 0.6836 (0.6499)  acc1: 58.3333 (58.8785)  acc5: 100.0000 (100.0000)  time: 1.5642  data: 1.5533  max mem: 1229
Test: Total time: 0:00:04 (1.5645 s / it)
* Acc@1 58.879 Acc@5 100.000 loss 0.650
Accuracy of the network on the 214 test images: 58.9%
Max accuracy: 62.62%
/home/qingchan/project/deit_smh/deit_smh/engine.py:86: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast():
Epoch: [17]  [0/7]  eta: 0:00:07  lr: 0.000015  loss: 0.6525 (0.6525)  time: 1.0171  data: 0.9835  max mem: 1229
Epoch: [17]  [6/7]  eta: 0:00:01  lr: 0.000015  loss: 0.6527 (0.6579)  time: 1.0192  data: 0.9857  max mem: 1229
Epoch: [17] Total time: 0:00:07 (1.0194 s / it)
Averaged stats: lr: 0.000015  loss: 0.6527 (0.6579)
/home/qingchan/project/deit_smh/deit_smh/engine.py:137: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast():
Test:  [0/3]  eta: 0:00:06  loss: 0.6862 (0.6862)  acc1: 60.4167 (60.4167)  acc5: 100.0000 (100.0000)  time: 2.0458  data: 2.0326  max mem: 1229
Test:  [2/3]  eta: 0:00:01  loss: 0.6839 (0.6476)  acc1: 60.4167 (59.3458)  acc5: 100.0000 (100.0000)  time: 1.5180  data: 1.5079  max mem: 1229
Test: Total time: 0:00:04 (1.5183 s / it)
* Acc@1 59.346 Acc@5 100.000 loss 0.648
Accuracy of the network on the 214 test images: 59.3%
Max accuracy: 62.62%
/home/qingchan/project/deit_smh/deit_smh/engine.py:86: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast():
Epoch: [18]  [0/7]  eta: 0:00:07  lr: 0.000013  loss: 0.6081 (0.6081)  time: 1.0161  data: 0.9837  max mem: 1229
Epoch: [18]  [6/7]  eta: 0:00:01  lr: 0.000013  loss: 0.6426 (0.6485)  time: 1.0421  data: 1.0090  max mem: 1229
Epoch: [18] Total time: 0:00:07 (1.0422 s / it)
Averaged stats: lr: 0.000013  loss: 0.6426 (0.6485)
/home/qingchan/project/deit_smh/deit_smh/engine.py:137: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast():
Test:  [0/3]  eta: 0:00:05  loss: 0.6871 (0.6871)  acc1: 60.4167 (60.4167)  acc5: 100.0000 (100.0000)  time: 1.9868  data: 1.9738  max mem: 1229
Test:  [2/3]  eta: 0:00:01  loss: 0.6791 (0.6462)  acc1: 60.4167 (60.7477)  acc5: 100.0000 (100.0000)  time: 1.4863  data: 1.4762  max mem: 1229
Test: Total time: 0:00:04 (1.4867 s / it)
* Acc@1 60.748 Acc@5 100.000 loss 0.646
Accuracy of the network on the 214 test images: 60.7%
Max accuracy: 62.62%
/home/qingchan/project/deit_smh/deit_smh/engine.py:86: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast():
Epoch: [19]  [0/7]  eta: 0:00:06  lr: 0.000011  loss: 0.6305 (0.6305)  time: 0.9984  data: 0.9661  max mem: 1229
Epoch: [19]  [6/7]  eta: 0:00:01  lr: 0.000011  loss: 0.6553 (0.6487)  time: 1.0450  data: 1.0116  max mem: 1229
Epoch: [19] Total time: 0:00:07 (1.0452 s / it)
Averaged stats: lr: 0.000011  loss: 0.6553 (0.6487)
/home/qingchan/project/deit_smh/deit_smh/engine.py:137: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast():
Test:  [0/3]  eta: 0:00:06  loss: 0.6869 (0.6869)  acc1: 60.4167 (60.4167)  acc5: 100.0000 (100.0000)  time: 2.0753  data: 2.0622  max mem: 1229
Test:  [2/3]  eta: 0:00:01  loss: 0.6769 (0.6450)  acc1: 60.4167 (61.6822)  acc5: 100.0000 (100.0000)  time: 1.5562  data: 1.5461  max mem: 1229
Test: Total time: 0:00:04 (1.5565 s / it)
* Acc@1 61.682 Acc@5 100.000 loss 0.645
Accuracy of the network on the 214 test images: 61.7%
Max accuracy: 62.62%
Training time 0:05:35
