Not using distributed mode
Namespace(batch_size=64, epochs=100, bce_loss=False, unscale_lr=False, model='deit_tiny_patch16_224', input_size=224, drop=0.0, drop_path=0.1, model_ema=True, model_ema_decay=0.99996, model_ema_force_cpu=False, opt='adamw', opt_eps=1e-08, opt_betas=None, clip_grad=None, momentum=0.9, weight_decay=0.05, sched='cosine', lr=0.0005, lr_noise=None, lr_noise_pct=0.67, lr_noise_std=1.0, warmup_lr=1e-06, min_lr=1e-05, decay_epochs=30, warmup_epochs=5, cooldown_epochs=10, patience_epochs=10, decay_rate=0.1, color_jitter=0.3, aa='rand-m9-mstd0.5-inc1', smoothing=0.1, train_interpolation='bicubic', repeated_aug=True, train_mode=True, ThreeAugment=False, src=False, reprob=0.25, remode='pixel', recount=1, resplit=False, mixup=0.8, cutmix=1.0, cutmix_minmax=None, mixup_prob=1.0, mixup_switch_prob=0.5, mixup_mode='batch', teacher_model='regnety_160', teacher_path='', distillation_type='none', distillation_alpha=0.5, distillation_tau=1.0, cosub=False, finetune='', attn_only=False, data_path='/home/shared_data/salmonella_detection/OriginalData/AfricanData', data_set='Smh_custom', inat_category='name', output_dir='/home/shared_data/salmonella_detection/smh_shared_output/african_from_scratch', device='cuda', seed=0, resume='', start_epoch=0, eval=False, eval_crop_ratio=0.875, dist_eval=False, num_workers=0, pin_mem=True, distributed=False, world_size=1, dist_url='env://', logger=True, exp_name='african_from_scratch_100ep', val_ratio=0.3)
Creating model: deit_tiny_patch16_224
number of params: 5524802
/home/qingchan/micromamba/envs/smh_dect/lib/python3.12/site-packages/timm/utils/cuda.py:50: FutureWarning: `torch.cuda.amp.GradScaler(args...)` is deprecated. Please use `torch.amp.GradScaler('cuda', args...)` instead.
  self._scaler = torch.cuda.amp.GradScaler()
Start training for 100 epochs
/home/qingchan/project/deit_smh/deit_smh/engine.py:86: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast():
Epoch: [0]  [ 0/47]  eta: 0:02:02  lr: 0.000001  loss: 0.6992 (0.6992)  time: 2.6085  data: 2.1944  max mem: 1186
Epoch: [0]  [10/47]  eta: 0:01:27  lr: 0.000001  loss: 0.6872 (0.6856)  time: 2.3758  data: 2.3064  max mem: 1229
Epoch: [0]  [20/47]  eta: 0:01:02  lr: 0.000001  loss: 0.6872 (0.6879)  time: 2.3034  data: 2.2694  max mem: 1229
Epoch: [0]  [30/47]  eta: 0:00:38  lr: 0.000001  loss: 0.6855 (0.6864)  time: 2.2268  data: 2.1937  max mem: 1229
Epoch: [0]  [40/47]  eta: 0:00:15  lr: 0.000001  loss: 0.6829 (0.6846)  time: 2.1969  data: 2.1638  max mem: 1229
Epoch: [0]  [46/47]  eta: 0:00:02  lr: 0.000001  loss: 0.6805 (0.6842)  time: 2.1698  data: 2.1365  max mem: 1229
Epoch: [0] Total time: 0:01:45 (2.2382 s / it)
Averaged stats: lr: 0.000001  loss: 0.6805 (0.6842)
/home/qingchan/project/deit_smh/deit_smh/engine.py:137: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast():
Test:  [ 0/14]  eta: 0:00:51  loss: 0.6352 (0.6352)  acc1: 81.2500 (81.2500)  acc5: 100.0000 (100.0000)  time: 3.6777  data: 3.6264  max mem: 1229
Test:  [10/14]  eta: 0:00:15  loss: 0.6371 (0.6359)  acc1: 78.1250 (77.8409)  acc5: 100.0000 (100.0000)  time: 3.8797  data: 3.8632  max mem: 1229
Test:  [13/14]  eta: 0:00:03  loss: 0.6370 (0.6361)  acc1: 77.0833 (77.7521)  acc5: 100.0000 (100.0000)  time: 3.7348  data: 3.7177  max mem: 1229
Test: Total time: 0:00:52 (3.7349 s / it)
* Acc@1 77.752 Acc@5 100.000 loss 0.636
Accuracy of the network on the 1299 test images: 77.8%
Max accuracy: 77.75%
/home/qingchan/project/deit_smh/deit_smh/engine.py:86: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast():
Epoch: [1]  [ 0/47]  eta: 0:01:13  lr: 0.000001  loss: 0.6808 (0.6808)  time: 1.5603  data: 1.5240  max mem: 1229
Epoch: [1]  [10/47]  eta: 0:01:08  lr: 0.000001  loss: 0.6771 (0.6780)  time: 1.8479  data: 1.8146  max mem: 1229
Epoch: [1]  [20/47]  eta: 0:00:49  lr: 0.000001  loss: 0.6730 (0.6746)  time: 1.8464  data: 1.8134  max mem: 1229
Epoch: [1]  [30/47]  eta: 0:00:31  lr: 0.000001  loss: 0.6738 (0.6757)  time: 1.8417  data: 1.8087  max mem: 1229
Epoch: [1]  [40/47]  eta: 0:00:13  lr: 0.000001  loss: 0.6679 (0.6722)  time: 1.9182  data: 1.8851  max mem: 1229
Epoch: [1]  [46/47]  eta: 0:00:01  lr: 0.000001  loss: 0.6685 (0.6722)  time: 1.9837  data: 1.9504  max mem: 1229
Epoch: [1] Total time: 0:01:28 (1.8804 s / it)
Averaged stats: lr: 0.000001  loss: 0.6685 (0.6722)
/home/qingchan/project/deit_smh/deit_smh/engine.py:137: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast():
Test:  [ 0/14]  eta: 0:00:51  loss: 0.5994 (0.5994)  acc1: 82.2917 (82.2917)  acc5: 100.0000 (100.0000)  time: 3.6719  data: 3.6588  max mem: 1229
Test:  [10/14]  eta: 0:00:15  loss: 0.6053 (0.6030)  acc1: 78.1250 (78.9773)  acc5: 100.0000 (100.0000)  time: 3.9250  data: 3.9119  max mem: 1229
Test:  [13/14]  eta: 0:00:03  loss: 0.6053 (0.6027)  acc1: 78.1250 (78.9838)  acc5: 100.0000 (100.0000)  time: 3.8192  data: 3.8066  max mem: 1229
Test: Total time: 0:00:53 (3.8193 s / it)
* Acc@1 78.984 Acc@5 100.000 loss 0.603
Accuracy of the network on the 1299 test images: 79.0%
Max accuracy: 78.98%
/home/qingchan/project/deit_smh/deit_smh/engine.py:86: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast():
Epoch: [2]  [ 0/47]  eta: 0:01:35  lr: 0.000013  loss: 0.6479 (0.6479)  time: 2.0273  data: 1.9948  max mem: 1229
Epoch: [2]  [10/47]  eta: 0:01:13  lr: 0.000013  loss: 0.6493 (0.6493)  time: 1.9836  data: 1.9505  max mem: 1229
Epoch: [2]  [20/47]  eta: 0:00:53  lr: 0.000013  loss: 0.6376 (0.6503)  time: 1.9905  data: 1.9572  max mem: 1229
Epoch: [2]  [30/47]  eta: 0:00:33  lr: 0.000013  loss: 0.6434 (0.6534)  time: 1.9332  data: 1.9002  max mem: 1229
Epoch: [2]  [40/47]  eta: 0:00:13  lr: 0.000013  loss: 0.6434 (0.6530)  time: 1.8890  data: 1.8562  max mem: 1229
Epoch: [2]  [46/47]  eta: 0:00:01  lr: 0.000013  loss: 0.6636 (0.6555)  time: 1.8490  data: 1.8160  max mem: 1229
Epoch: [2] Total time: 0:01:30 (1.9249 s / it)
Averaged stats: lr: 0.000013  loss: 0.6636 (0.6555)
/home/qingchan/project/deit_smh/deit_smh/engine.py:137: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast():
Test:  [ 0/14]  eta: 0:00:50  loss: 0.4786 (0.4786)  acc1: 85.4167 (85.4167)  acc5: 100.0000 (100.0000)  time: 3.5862  data: 3.5730  max mem: 1229
Test:  [10/14]  eta: 0:00:15  loss: 0.5031 (0.5025)  acc1: 80.2083 (80.4924)  acc5: 100.0000 (100.0000)  time: 3.9039  data: 3.8907  max mem: 1229
Test:  [13/14]  eta: 0:00:03  loss: 0.5031 (0.5005)  acc1: 79.1667 (80.2925)  acc5: 100.0000 (100.0000)  time: 3.7597  data: 3.7470  max mem: 1229
Test: Total time: 0:00:52 (3.7598 s / it)
* Acc@1 80.293 Acc@5 100.000 loss 0.501
Accuracy of the network on the 1299 test images: 80.3%
Max accuracy: 80.29%
/home/qingchan/project/deit_smh/deit_smh/engine.py:86: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast():
Epoch: [3]  [ 0/47]  eta: 0:01:14  lr: 0.000026  loss: 0.6069 (0.6069)  time: 1.5775  data: 1.5454  max mem: 1229
Epoch: [3]  [10/47]  eta: 0:01:11  lr: 0.000026  loss: 0.6483 (0.6402)  time: 1.9239  data: 1.8908  max mem: 1229
Epoch: [3]  [20/47]  eta: 0:00:52  lr: 0.000026  loss: 0.6483 (0.6475)  time: 1.9458  data: 1.9125  max mem: 1229
Epoch: [3]  [30/47]  eta: 0:00:32  lr: 0.000026  loss: 0.6416 (0.6441)  time: 1.9080  data: 1.8748  max mem: 1229
Epoch: [3]  [40/47]  eta: 0:00:13  lr: 0.000026  loss: 0.6354 (0.6417)  time: 1.8749  data: 1.8416  max mem: 1229
Epoch: [3]  [46/47]  eta: 0:00:01  lr: 0.000026  loss: 0.6262 (0.6404)  time: 1.8701  data: 1.8370  max mem: 1229
Epoch: [3] Total time: 0:01:29 (1.8989 s / it)
Averaged stats: lr: 0.000026  loss: 0.6262 (0.6404)
/home/qingchan/project/deit_smh/deit_smh/engine.py:137: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast():
Test:  [ 0/14]  eta: 0:00:50  loss: 0.4075 (0.4075)  acc1: 89.5833 (89.5833)  acc5: 100.0000 (100.0000)  time: 3.6305  data: 3.6174  max mem: 1229
Test:  [10/14]  eta: 0:00:15  loss: 0.4439 (0.4407)  acc1: 87.5000 (86.4583)  acc5: 100.0000 (100.0000)  time: 3.9147  data: 3.9017  max mem: 1229
Test:  [13/14]  eta: 0:00:03  loss: 0.4381 (0.4413)  acc1: 87.5000 (86.2202)  acc5: 100.0000 (100.0000)  time: 3.7540  data: 3.7413  max mem: 1229
Test: Total time: 0:00:52 (3.7541 s / it)
* Acc@1 86.220 Acc@5 100.000 loss 0.441
Accuracy of the network on the 1299 test images: 86.2%
Max accuracy: 86.22%
/home/qingchan/project/deit_smh/deit_smh/engine.py:86: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast():
Epoch: [4]  [ 0/47]  eta: 0:01:38  lr: 0.000038  loss: 0.5584 (0.5584)  time: 2.1015  data: 2.0691  max mem: 1229
Epoch: [4]  [10/47]  eta: 0:01:13  lr: 0.000038  loss: 0.6078 (0.6169)  time: 1.9761  data: 1.9430  max mem: 1229
Epoch: [4]  [20/47]  eta: 0:00:51  lr: 0.000038  loss: 0.6078 (0.6151)  time: 1.9072  data: 1.8737  max mem: 1229
Epoch: [4]  [30/47]  eta: 0:00:32  lr: 0.000038  loss: 0.5977 (0.6117)  time: 1.8523  data: 1.8189  max mem: 1229
Epoch: [4]  [40/47]  eta: 0:00:13  lr: 0.000038  loss: 0.6293 (0.6259)  time: 1.8896  data: 1.8561  max mem: 1229
Epoch: [4]  [46/47]  eta: 0:00:01  lr: 0.000038  loss: 0.6293 (0.6251)  time: 1.9192  data: 1.8856  max mem: 1229
Epoch: [4] Total time: 0:01:29 (1.9098 s / it)
Averaged stats: lr: 0.000038  loss: 0.6293 (0.6251)
/home/qingchan/project/deit_smh/deit_smh/engine.py:137: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast():
Test:  [ 0/14]  eta: 0:00:49  loss: 0.4397 (0.4397)  acc1: 88.5417 (88.5417)  acc5: 100.0000 (100.0000)  time: 3.5355  data: 3.5224  max mem: 1229
Test:  [10/14]  eta: 0:00:15  loss: 0.4704 (0.4699)  acc1: 84.3750 (84.2803)  acc5: 100.0000 (100.0000)  time: 3.8562  data: 3.8431  max mem: 1229
Test:  [13/14]  eta: 0:00:03  loss: 0.4704 (0.4680)  acc1: 84.3750 (84.8345)  acc5: 100.0000 (100.0000)  time: 3.6969  data: 3.6843  max mem: 1229
Test: Total time: 0:00:51 (3.6971 s / it)
* Acc@1 84.834 Acc@5 100.000 loss 0.468
Accuracy of the network on the 1299 test images: 84.8%
Max accuracy: 86.22%
/home/qingchan/project/deit_smh/deit_smh/engine.py:86: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast():
Epoch: [5]  [ 0/47]  eta: 0:01:30  lr: 0.000050  loss: 0.6508 (0.6508)  time: 1.9177  data: 1.8851  max mem: 1229
Epoch: [5]  [10/47]  eta: 0:01:11  lr: 0.000050  loss: 0.6082 (0.6123)  time: 1.9383  data: 1.9050  max mem: 1229
Epoch: [5]  [20/47]  eta: 0:00:51  lr: 0.000050  loss: 0.6044 (0.6162)  time: 1.9214  data: 1.8881  max mem: 1229
Epoch: [5]  [30/47]  eta: 0:00:31  lr: 0.000050  loss: 0.6044 (0.6118)  time: 1.8507  data: 1.8174  max mem: 1229
Epoch: [5]  [40/47]  eta: 0:00:13  lr: 0.000050  loss: 0.5970 (0.6093)  time: 1.8628  data: 1.8296  max mem: 1229
Epoch: [5]  [46/47]  eta: 0:00:01  lr: 0.000050  loss: 0.6144 (0.6096)  time: 1.8514  data: 1.8181  max mem: 1229
Epoch: [5] Total time: 0:01:28 (1.8770 s / it)
Averaged stats: lr: 0.000050  loss: 0.6144 (0.6096)
/home/qingchan/project/deit_smh/deit_smh/engine.py:137: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast():
Test:  [ 0/14]  eta: 0:00:49  loss: 0.3432 (0.3432)  acc1: 90.6250 (90.6250)  acc5: 100.0000 (100.0000)  time: 3.5068  data: 3.4936  max mem: 1229
Test:  [10/14]  eta: 0:00:15  loss: 0.3967 (0.3924)  acc1: 86.4583 (86.5530)  acc5: 100.0000 (100.0000)  time: 3.8926  data: 3.8795  max mem: 1229
Test:  [13/14]  eta: 0:00:03  loss: 0.3951 (0.3938)  acc1: 86.4583 (86.6051)  acc5: 100.0000 (100.0000)  time: 3.7152  data: 3.7025  max mem: 1229
Test: Total time: 0:00:52 (3.7153 s / it)
* Acc@1 86.605 Acc@5 100.000 loss 0.394
Accuracy of the network on the 1299 test images: 86.6%
Max accuracy: 86.61%
/home/qingchan/project/deit_smh/deit_smh/engine.py:86: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast():
Epoch: [6]  [ 0/47]  eta: 0:01:27  lr: 0.000062  loss: 0.5428 (0.5428)  time: 1.8670  data: 1.8344  max mem: 1229
Epoch: [6]  [10/47]  eta: 0:01:10  lr: 0.000062  loss: 0.5697 (0.5669)  time: 1.8974  data: 1.8646  max mem: 1229
Epoch: [6]  [20/47]  eta: 0:00:52  lr: 0.000062  loss: 0.5864 (0.5929)  time: 1.9447  data: 1.9116  max mem: 1229
Epoch: [6]  [30/47]  eta: 0:00:32  lr: 0.000062  loss: 0.6299 (0.6085)  time: 1.9453  data: 1.9121  max mem: 1229
Epoch: [6]  [40/47]  eta: 0:00:13  lr: 0.000062  loss: 0.6299 (0.6086)  time: 1.8585  data: 1.8255  max mem: 1229
Epoch: [6]  [46/47]  eta: 0:00:01  lr: 0.000062  loss: 0.6101 (0.6068)  time: 1.8119  data: 1.7788  max mem: 1229
Epoch: [6] Total time: 0:01:28 (1.8825 s / it)
Averaged stats: lr: 0.000062  loss: 0.6101 (0.6068)
/home/qingchan/project/deit_smh/deit_smh/engine.py:137: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast():
Test:  [ 0/14]  eta: 0:00:49  loss: 0.3575 (0.3575)  acc1: 88.5417 (88.5417)  acc5: 100.0000 (100.0000)  time: 3.5431  data: 3.5300  max mem: 1229
Test:  [10/14]  eta: 0:00:15  loss: 0.4028 (0.4075)  acc1: 83.3333 (83.2386)  acc5: 100.0000 (100.0000)  time: 3.7956  data: 3.7825  max mem: 1229
Test:  [13/14]  eta: 0:00:03  loss: 0.4013 (0.4038)  acc1: 83.3333 (83.9107)  acc5: 100.0000 (100.0000)  time: 3.6577  data: 3.6451  max mem: 1229
Test: Total time: 0:00:51 (3.6578 s / it)
* Acc@1 83.911 Acc@5 100.000 loss 0.404
Accuracy of the network on the 1299 test images: 83.9%
Max accuracy: 86.61%
/home/qingchan/project/deit_smh/deit_smh/engine.py:86: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast():
Epoch: [7]  [ 0/47]  eta: 0:01:46  lr: 0.000062  loss: 0.6686 (0.6686)  time: 2.2642  data: 2.2278  max mem: 1229
Epoch: [7]  [10/47]  eta: 0:01:10  lr: 0.000062  loss: 0.5991 (0.6005)  time: 1.8974  data: 1.8648  max mem: 1229
Epoch: [7]  [20/47]  eta: 0:00:52  lr: 0.000062  loss: 0.5991 (0.5973)  time: 1.9143  data: 1.8813  max mem: 1229
Epoch: [7]  [30/47]  eta: 0:00:32  lr: 0.000062  loss: 0.5998 (0.5980)  time: 1.9443  data: 1.9107  max mem: 1229
Epoch: [7]  [40/47]  eta: 0:00:13  lr: 0.000062  loss: 0.5913 (0.5974)  time: 1.9143  data: 1.8808  max mem: 1229
Epoch: [7]  [46/47]  eta: 0:00:01  lr: 0.000062  loss: 0.5967 (0.5987)  time: 1.8889  data: 1.8556  max mem: 1229
Epoch: [7] Total time: 0:01:29 (1.9024 s / it)
Averaged stats: lr: 0.000062  loss: 0.5967 (0.5987)
/home/qingchan/project/deit_smh/deit_smh/engine.py:137: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast():
Test:  [ 0/14]  eta: 0:01:00  loss: 0.3506 (0.3506)  acc1: 90.6250 (90.6250)  acc5: 100.0000 (100.0000)  time: 4.3009  data: 4.2879  max mem: 1229
Test:  [10/14]  eta: 0:00:16  loss: 0.3889 (0.3875)  acc1: 89.5833 (89.6780)  acc5: 100.0000 (100.0000)  time: 4.0232  data: 4.0102  max mem: 1229
Test:  [13/14]  eta: 0:00:03  loss: 0.3889 (0.3874)  acc1: 89.5833 (89.6844)  acc5: 100.0000 (100.0000)  time: 3.8940  data: 3.8814  max mem: 1229
Test: Total time: 0:00:54 (3.8942 s / it)
* Acc@1 89.684 Acc@5 100.000 loss 0.387
Accuracy of the network on the 1299 test images: 89.7%
Max accuracy: 89.68%
/home/qingchan/project/deit_smh/deit_smh/engine.py:86: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast():
Epoch: [8]  [ 0/47]  eta: 0:01:39  lr: 0.000062  loss: 0.6068 (0.6068)  time: 2.1197  data: 2.0875  max mem: 1229
Epoch: [8]  [10/47]  eta: 0:01:12  lr: 0.000062  loss: 0.5777 (0.5709)  time: 1.9685  data: 1.9355  max mem: 1229
Epoch: [8]  [20/47]  eta: 0:00:54  lr: 0.000062  loss: 0.5801 (0.5867)  time: 1.9971  data: 1.9639  max mem: 1229
Epoch: [8]  [30/47]  eta: 0:00:33  lr: 0.000062  loss: 0.6095 (0.6005)  time: 2.0028  data: 1.9693  max mem: 1229
Epoch: [8]  [40/47]  eta: 0:00:13  lr: 0.000062  loss: 0.6136 (0.5991)  time: 1.9356  data: 1.9020  max mem: 1229
Epoch: [8]  [46/47]  eta: 0:00:01  lr: 0.000062  loss: 0.6095 (0.5988)  time: 1.9036  data: 1.8702  max mem: 1229
Epoch: [8] Total time: 0:01:32 (1.9605 s / it)
Averaged stats: lr: 0.000062  loss: 0.6095 (0.5988)
/home/qingchan/project/deit_smh/deit_smh/engine.py:137: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast():
Test:  [ 0/14]  eta: 0:00:49  loss: 0.3072 (0.3072)  acc1: 90.6250 (90.6250)  acc5: 100.0000 (100.0000)  time: 3.5031  data: 3.4887  max mem: 1229
Test:  [10/14]  eta: 0:00:15  loss: 0.3482 (0.3461)  acc1: 89.5833 (89.2045)  acc5: 100.0000 (100.0000)  time: 3.8354  data: 3.8221  max mem: 1229
Test:  [13/14]  eta: 0:00:03  loss: 0.3442 (0.3438)  acc1: 89.5833 (89.7614)  acc5: 100.0000 (100.0000)  time: 3.6783  data: 3.6656  max mem: 1229
Test: Total time: 0:00:51 (3.6784 s / it)
* Acc@1 89.761 Acc@5 100.000 loss 0.344
Accuracy of the network on the 1299 test images: 89.8%
Max accuracy: 89.76%
/home/qingchan/project/deit_smh/deit_smh/engine.py:86: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast():
Epoch: [9]  [ 0/47]  eta: 0:01:29  lr: 0.000062  loss: 0.5903 (0.5903)  time: 1.9085  data: 1.8734  max mem: 1229
Epoch: [9]  [10/47]  eta: 0:01:10  lr: 0.000062  loss: 0.5903 (0.5720)  time: 1.9085  data: 1.8749  max mem: 1229
Epoch: [9]  [20/47]  eta: 0:00:51  lr: 0.000062  loss: 0.5942 (0.5855)  time: 1.9101  data: 1.8768  max mem: 1229
Epoch: [9]  [30/47]  eta: 0:00:32  lr: 0.000062  loss: 0.5942 (0.5846)  time: 1.8919  data: 1.8584  max mem: 1229
Epoch: [9]  [40/47]  eta: 0:00:13  lr: 0.000062  loss: 0.6002 (0.5910)  time: 1.9132  data: 1.8798  max mem: 1229
Epoch: [9]  [46/47]  eta: 0:00:01  lr: 0.000062  loss: 0.5859 (0.5890)  time: 1.9509  data: 1.9179  max mem: 1229
Epoch: [9] Total time: 0:01:30 (1.9168 s / it)
Averaged stats: lr: 0.000062  loss: 0.5859 (0.5890)
/home/qingchan/project/deit_smh/deit_smh/engine.py:137: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast():
Test:  [ 0/14]  eta: 0:00:51  loss: 0.3401 (0.3401)  acc1: 89.5833 (89.5833)  acc5: 100.0000 (100.0000)  time: 3.6992  data: 3.6862  max mem: 1229
Test:  [10/14]  eta: 0:00:15  loss: 0.3804 (0.3758)  acc1: 86.4583 (86.7424)  acc5: 100.0000 (100.0000)  time: 3.8879  data: 3.8749  max mem: 1229
Test:  [13/14]  eta: 0:00:03  loss: 0.3735 (0.3714)  acc1: 86.4583 (87.3749)  acc5: 100.0000 (100.0000)  time: 3.7303  data: 3.7176  max mem: 1229
Test: Total time: 0:00:52 (3.7304 s / it)
* Acc@1 87.375 Acc@5 100.000 loss 0.371
Accuracy of the network on the 1299 test images: 87.4%
Max accuracy: 89.76%
/home/qingchan/project/deit_smh/deit_smh/engine.py:86: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast():
Epoch: [10]  [ 0/47]  eta: 0:01:32  lr: 0.000061  loss: 0.5617 (0.5617)  time: 1.9746  data: 1.9422  max mem: 1229
Epoch: [10]  [10/47]  eta: 0:01:15  lr: 0.000061  loss: 0.5617 (0.5698)  time: 2.0343  data: 2.0006  max mem: 1229
Epoch: [10]  [20/47]  eta: 0:00:54  lr: 0.000061  loss: 0.5499 (0.5605)  time: 2.0044  data: 1.9709  max mem: 1229
Epoch: [10]  [30/47]  eta: 0:00:33  lr: 0.000061  loss: 0.5679 (0.5718)  time: 1.9639  data: 1.9305  max mem: 1229
Epoch: [10]  [40/47]  eta: 0:00:13  lr: 0.000061  loss: 0.5813 (0.5746)  time: 1.9852  data: 1.9520  max mem: 1229
Epoch: [10]  [46/47]  eta: 0:00:01  lr: 0.000061  loss: 0.5854 (0.5801)  time: 1.9815  data: 1.9485  max mem: 1229
Epoch: [10] Total time: 0:01:33 (1.9900 s / it)
Averaged stats: lr: 0.000061  loss: 0.5854 (0.5801)
/home/qingchan/project/deit_smh/deit_smh/engine.py:137: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast():
Test:  [ 0/14]  eta: 0:00:50  loss: 0.3363 (0.3363)  acc1: 90.6250 (90.6250)  acc5: 100.0000 (100.0000)  time: 3.5880  data: 3.5749  max mem: 1229
Test:  [10/14]  eta: 0:00:15  loss: 0.3641 (0.3639)  acc1: 87.5000 (88.0682)  acc5: 100.0000 (100.0000)  time: 3.9097  data: 3.8966  max mem: 1229
Test:  [13/14]  eta: 0:00:03  loss: 0.3591 (0.3599)  acc1: 87.5000 (88.6836)  acc5: 100.0000 (100.0000)  time: 3.7514  data: 3.7387  max mem: 1229
Test: Total time: 0:00:52 (3.7515 s / it)
* Acc@1 88.684 Acc@5 100.000 loss 0.360
Accuracy of the network on the 1299 test images: 88.7%
Max accuracy: 89.76%
/home/qingchan/project/deit_smh/deit_smh/engine.py:86: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast():
Epoch: [11]  [ 0/47]  eta: 0:01:27  lr: 0.000061  loss: 0.5910 (0.5910)  time: 1.8697  data: 1.8370  max mem: 1229
Epoch: [11]  [10/47]  eta: 0:01:13  lr: 0.000061  loss: 0.5910 (0.5766)  time: 1.9802  data: 1.9471  max mem: 1229
Epoch: [11]  [20/47]  eta: 0:00:51  lr: 0.000061  loss: 0.5758 (0.5673)  time: 1.9253  data: 1.8922  max mem: 1229
Epoch: [11]  [30/47]  eta: 0:00:33  lr: 0.000061  loss: 0.5983 (0.5857)  time: 1.9606  data: 1.9272  max mem: 1229
Epoch: [11]  [40/47]  eta: 0:00:13  lr: 0.000061  loss: 0.6140 (0.5874)  time: 2.0444  data: 2.0111  max mem: 1229
Epoch: [11]  [46/47]  eta: 0:00:01  lr: 0.000061  loss: 0.5983 (0.5882)  time: 2.0413  data: 2.0081  max mem: 1229
Epoch: [11] Total time: 0:01:33 (1.9901 s / it)
Averaged stats: lr: 0.000061  loss: 0.5983 (0.5882)
/home/qingchan/project/deit_smh/deit_smh/engine.py:137: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast():
Test:  [ 0/14]  eta: 0:00:53  loss: 0.3191 (0.3191)  acc1: 89.5833 (89.5833)  acc5: 100.0000 (100.0000)  time: 3.7894  data: 3.7764  max mem: 1229
Test:  [10/14]  eta: 0:00:16  loss: 0.3473 (0.3447)  acc1: 89.5833 (89.9621)  acc5: 100.0000 (100.0000)  time: 4.1229  data: 4.1098  max mem: 1229
Test:  [13/14]  eta: 0:00:03  loss: 0.3417 (0.3403)  acc1: 90.1961 (90.4542)  acc5: 100.0000 (100.0000)  time: 3.9301  data: 3.9174  max mem: 1229
Test: Total time: 0:00:55 (3.9302 s / it)
* Acc@1 90.454 Acc@5 100.000 loss 0.340
Accuracy of the network on the 1299 test images: 90.5%
Max accuracy: 90.45%
/home/qingchan/project/deit_smh/deit_smh/engine.py:86: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast():
Epoch: [12]  [ 0/47]  eta: 0:01:22  lr: 0.000061  loss: 0.5788 (0.5788)  time: 1.7659  data: 1.7335  max mem: 1229
Epoch: [12]  [10/47]  eta: 0:01:11  lr: 0.000061  loss: 0.5688 (0.5744)  time: 1.9337  data: 1.9007  max mem: 1229
Epoch: [12]  [20/47]  eta: 0:00:54  lr: 0.000061  loss: 0.5696 (0.5850)  time: 2.0265  data: 1.9932  max mem: 1229
Epoch: [12]  [30/47]  eta: 0:00:34  lr: 0.000061  loss: 0.5696 (0.5772)  time: 2.0532  data: 2.0196  max mem: 1229
Epoch: [12]  [40/47]  eta: 0:00:13  lr: 0.000061  loss: 0.5447 (0.5752)  time: 1.9591  data: 1.9257  max mem: 1229
Epoch: [12]  [46/47]  eta: 0:00:01  lr: 0.000061  loss: 0.5708 (0.5772)  time: 1.9418  data: 1.9085  max mem: 1229
Epoch: [12] Total time: 0:01:33 (1.9806 s / it)
Averaged stats: lr: 0.000061  loss: 0.5708 (0.5772)
/home/qingchan/project/deit_smh/deit_smh/engine.py:137: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast():
Test:  [ 0/14]  eta: 0:00:53  loss: 0.2748 (0.2748)  acc1: 90.6250 (90.6250)  acc5: 100.0000 (100.0000)  time: 3.8097  data: 3.7957  max mem: 1229
Test:  [10/14]  eta: 0:00:15  loss: 0.2983 (0.3039)  acc1: 90.6250 (90.2462)  acc5: 100.0000 (100.0000)  time: 3.9808  data: 3.9676  max mem: 1229
Test:  [13/14]  eta: 0:00:03  loss: 0.2983 (0.3018)  acc1: 90.6250 (90.4542)  acc5: 100.0000 (100.0000)  time: 3.8063  data: 3.7936  max mem: 1229
Test: Total time: 0:00:53 (3.8065 s / it)
* Acc@1 90.454 Acc@5 100.000 loss 0.302
Accuracy of the network on the 1299 test images: 90.5%
Max accuracy: 90.45%
/home/qingchan/project/deit_smh/deit_smh/engine.py:86: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast():
Epoch: [13]  [ 0/47]  eta: 0:01:31  lr: 0.000061  loss: 0.6335 (0.6335)  time: 1.9382  data: 1.9018  max mem: 1229
Epoch: [13]  [10/47]  eta: 0:01:16  lr: 0.000061  loss: 0.5896 (0.5975)  time: 2.0629  data: 2.0298  max mem: 1229
Epoch: [13]  [20/47]  eta: 0:00:55  lr: 0.000061  loss: 0.5896 (0.6026)  time: 2.0707  data: 2.0375  max mem: 1229
Epoch: [13]  [30/47]  eta: 0:00:34  lr: 0.000061  loss: 0.5947 (0.6003)  time: 2.0083  data: 1.9748  max mem: 1229
Epoch: [13]  [40/47]  eta: 0:00:13  lr: 0.000061  loss: 0.5763 (0.5896)  time: 1.9239  data: 1.8904  max mem: 1229
Epoch: [13]  [46/47]  eta: 0:00:01  lr: 0.000061  loss: 0.5686 (0.5924)  time: 1.9090  data: 1.8756  max mem: 1229
Epoch: [13] Total time: 0:01:33 (1.9842 s / it)
Averaged stats: lr: 0.000061  loss: 0.5686 (0.5924)
/home/qingchan/project/deit_smh/deit_smh/engine.py:137: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast():
Test:  [ 0/14]  eta: 0:00:54  loss: 0.2737 (0.2737)  acc1: 92.7083 (92.7083)  acc5: 100.0000 (100.0000)  time: 3.8945  data: 3.8815  max mem: 1229
Test:  [10/14]  eta: 0:00:15  loss: 0.2865 (0.3006)  acc1: 90.6250 (90.8144)  acc5: 100.0000 (100.0000)  time: 3.9525  data: 3.9394  max mem: 1229
Test:  [13/14]  eta: 0:00:03  loss: 0.2865 (0.2995)  acc1: 89.5833 (90.7621)  acc5: 100.0000 (100.0000)  time: 3.8020  data: 3.7894  max mem: 1229
Test: Total time: 0:00:53 (3.8021 s / it)
* Acc@1 90.762 Acc@5 100.000 loss 0.299
Accuracy of the network on the 1299 test images: 90.8%
Max accuracy: 90.76%
/home/qingchan/project/deit_smh/deit_smh/engine.py:86: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast():
Epoch: [14]  [ 0/47]  eta: 0:01:38  lr: 0.000060  loss: 0.5820 (0.5820)  time: 2.0885  data: 2.0560  max mem: 1229
Epoch: [14]  [10/47]  eta: 0:01:12  lr: 0.000060  loss: 0.5687 (0.5666)  time: 1.9538  data: 1.9210  max mem: 1229
Epoch: [14]  [20/47]  eta: 0:00:54  lr: 0.000060  loss: 0.5672 (0.5668)  time: 1.9970  data: 1.9640  max mem: 1229
Epoch: [14]  [30/47]  eta: 0:00:33  lr: 0.000060  loss: 0.5709 (0.5742)  time: 2.0008  data: 1.9679  max mem: 1229
Epoch: [14]  [40/47]  eta: 0:00:13  lr: 0.000060  loss: 0.5886 (0.5768)  time: 1.9758  data: 1.9355  max mem: 1229
Epoch: [14]  [46/47]  eta: 0:00:01  lr: 0.000060  loss: 0.5839 (0.5757)  time: 2.0193  data: 1.9791  max mem: 1229
Epoch: [14] Total time: 0:01:33 (1.9889 s / it)
Averaged stats: lr: 0.000060  loss: 0.5839 (0.5757)
/home/qingchan/project/deit_smh/deit_smh/engine.py:137: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast():
Test:  [ 0/14]  eta: 0:00:52  loss: 0.2711 (0.2711)  acc1: 89.5833 (89.5833)  acc5: 100.0000 (100.0000)  time: 3.7505  data: 3.7362  max mem: 1229
Test:  [10/14]  eta: 0:00:15  loss: 0.2944 (0.2959)  acc1: 90.6250 (91.0038)  acc5: 100.0000 (100.0000)  time: 3.9139  data: 3.9007  max mem: 1229
Test:  [13/14]  eta: 0:00:03  loss: 0.2930 (0.2947)  acc1: 90.6250 (91.3780)  acc5: 100.0000 (100.0000)  time: 3.7482  data: 3.7355  max mem: 1229
Test: Total time: 0:00:52 (3.7483 s / it)
* Acc@1 91.378 Acc@5 100.000 loss 0.295
Accuracy of the network on the 1299 test images: 91.4%
Max accuracy: 91.38%
/home/qingchan/project/deit_smh/deit_smh/engine.py:86: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast():
Epoch: [15]  [ 0/47]  eta: 0:01:22  lr: 0.000060  loss: 0.5951 (0.5951)  time: 1.7455  data: 1.7130  max mem: 1229
Epoch: [15]  [10/47]  eta: 0:01:11  lr: 0.000060  loss: 0.5838 (0.5457)  time: 1.9323  data: 1.8989  max mem: 1229
Epoch: [15]  [20/47]  eta: 0:00:50  lr: 0.000060  loss: 0.5648 (0.5575)  time: 1.8801  data: 1.8465  max mem: 1229
Epoch: [15]  [30/47]  eta: 0:00:31  lr: 0.000060  loss: 0.5615 (0.5584)  time: 1.8135  data: 1.7804  max mem: 1229
Epoch: [15]  [40/47]  eta: 0:00:13  lr: 0.000060  loss: 0.5625 (0.5587)  time: 1.9105  data: 1.8777  max mem: 1229
Epoch: [15]  [46/47]  eta: 0:00:01  lr: 0.000060  loss: 0.5841 (0.5565)  time: 1.9447  data: 1.9118  max mem: 1229
Epoch: [15] Total time: 0:01:29 (1.8949 s / it)
Averaged stats: lr: 0.000060  loss: 0.5841 (0.5565)
/home/qingchan/project/deit_smh/deit_smh/engine.py:137: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast():
Test:  [ 0/14]  eta: 0:00:51  loss: 0.2412 (0.2412)  acc1: 91.6667 (91.6667)  acc5: 100.0000 (100.0000)  time: 3.6994  data: 3.6863  max mem: 1229
Test:  [10/14]  eta: 0:00:15  loss: 0.2797 (0.2721)  acc1: 90.6250 (90.7197)  acc5: 100.0000 (100.0000)  time: 3.9153  data: 3.9023  max mem: 1229
Test:  [13/14]  eta: 0:00:03  loss: 0.2765 (0.2697)  acc1: 90.6250 (91.1470)  acc5: 100.0000 (100.0000)  time: 3.7555  data: 3.7429  max mem: 1229
Test: Total time: 0:00:52 (3.7556 s / it)
* Acc@1 91.147 Acc@5 100.000 loss 0.270
Accuracy of the network on the 1299 test images: 91.1%
Max accuracy: 91.38%
/home/qingchan/project/deit_smh/deit_smh/engine.py:86: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast():
Epoch: [16]  [ 0/47]  eta: 0:01:32  lr: 0.000060  loss: 0.5761 (0.5761)  time: 1.9599  data: 1.9278  max mem: 1229
Epoch: [16]  [10/47]  eta: 0:01:12  lr: 0.000060  loss: 0.5761 (0.5676)  time: 1.9614  data: 1.9286  max mem: 1229
Epoch: [16]  [20/47]  eta: 0:00:52  lr: 0.000060  loss: 0.5549 (0.5660)  time: 1.9460  data: 1.9127  max mem: 1229
Epoch: [16]  [30/47]  eta: 0:00:33  lr: 0.000060  loss: 0.5838 (0.5801)  time: 1.9462  data: 1.9128  max mem: 1229
Epoch: [16]  [40/47]  eta: 0:00:13  lr: 0.000060  loss: 0.5838 (0.5779)  time: 1.9231  data: 1.8901  max mem: 1229
Epoch: [16]  [46/47]  eta: 0:00:01  lr: 0.000060  loss: 0.5822 (0.5746)  time: 1.8457  data: 1.8125  max mem: 1229
Epoch: [16] Total time: 0:01:29 (1.9073 s / it)
Averaged stats: lr: 0.000060  loss: 0.5822 (0.5746)
/home/qingchan/project/deit_smh/deit_smh/engine.py:137: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast():
Test:  [ 0/14]  eta: 0:00:50  loss: 0.3001 (0.3001)  acc1: 92.7083 (92.7083)  acc5: 100.0000 (100.0000)  time: 3.6020  data: 3.5889  max mem: 1229
Test:  [10/14]  eta: 0:00:15  loss: 0.3199 (0.3189)  acc1: 91.6667 (91.4773)  acc5: 100.0000 (100.0000)  time: 3.9534  data: 3.9403  max mem: 1229
Test:  [13/14]  eta: 0:00:03  loss: 0.3152 (0.3158)  acc1: 91.6667 (91.9169)  acc5: 100.0000 (100.0000)  time: 3.7981  data: 3.7853  max mem: 1229
Test: Total time: 0:00:53 (3.7982 s / it)
* Acc@1 91.917 Acc@5 100.000 loss 0.316
Accuracy of the network on the 1299 test images: 91.9%
Max accuracy: 91.92%
/home/qingchan/project/deit_smh/deit_smh/engine.py:86: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast():
Epoch: [17]  [ 0/47]  eta: 0:01:31  lr: 0.000059  loss: 0.4532 (0.4532)  time: 1.9386  data: 1.9061  max mem: 1229
Epoch: [17]  [10/47]  eta: 0:01:07  lr: 0.000059  loss: 0.5768 (0.5571)  time: 1.8327  data: 1.7991  max mem: 1229
Epoch: [17]  [20/47]  eta: 0:00:49  lr: 0.000059  loss: 0.5790 (0.5642)  time: 1.8144  data: 1.7810  max mem: 1229
Epoch: [17]  [30/47]  eta: 0:00:31  lr: 0.000059  loss: 0.5804 (0.5712)  time: 1.8591  data: 1.8259  max mem: 1229
Epoch: [17]  [40/47]  eta: 0:00:12  lr: 0.000059  loss: 0.5749 (0.5699)  time: 1.8536  data: 1.8205  max mem: 1229
Epoch: [17]  [46/47]  eta: 0:00:01  lr: 0.000059  loss: 0.5648 (0.5665)  time: 1.8806  data: 1.8475  max mem: 1229
Epoch: [17] Total time: 0:01:27 (1.8615 s / it)
Averaged stats: lr: 0.000059  loss: 0.5648 (0.5665)
/home/qingchan/project/deit_smh/deit_smh/engine.py:137: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast():
Test:  [ 0/14]  eta: 0:00:49  loss: 0.2736 (0.2736)  acc1: 91.6667 (91.6667)  acc5: 100.0000 (100.0000)  time: 3.5592  data: 3.5461  max mem: 1229
Test:  [10/14]  eta: 0:00:15  loss: 0.3032 (0.2981)  acc1: 91.6667 (91.8561)  acc5: 100.0000 (100.0000)  time: 3.8360  data: 3.8230  max mem: 1229
Test:  [13/14]  eta: 0:00:03  loss: 0.3018 (0.2952)  acc1: 91.6667 (91.9938)  acc5: 100.0000 (100.0000)  time: 3.6873  data: 3.6747  max mem: 1229
Test: Total time: 0:00:51 (3.6874 s / it)
* Acc@1 91.994 Acc@5 100.000 loss 0.295
Accuracy of the network on the 1299 test images: 92.0%
Max accuracy: 91.99%
/home/qingchan/project/deit_smh/deit_smh/engine.py:86: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast():
Epoch: [18]  [ 0/47]  eta: 0:01:46  lr: 0.000059  loss: 0.6218 (0.6218)  time: 2.2611  data: 2.2288  max mem: 1229
Epoch: [18]  [10/47]  eta: 0:01:08  lr: 0.000059  loss: 0.5618 (0.5634)  time: 1.8516  data: 1.8189  max mem: 1229
Epoch: [18]  [20/47]  eta: 0:00:49  lr: 0.000059  loss: 0.5618 (0.5699)  time: 1.8130  data: 1.7802  max mem: 1229
Epoch: [18]  [30/47]  eta: 0:00:31  lr: 0.000059  loss: 0.5394 (0.5603)  time: 1.8969  data: 1.8637  max mem: 1229
Epoch: [18]  [40/47]  eta: 0:00:13  lr: 0.000059  loss: 0.5394 (0.5606)  time: 1.9564  data: 1.9229  max mem: 1229
Epoch: [18]  [46/47]  eta: 0:00:01  lr: 0.000059  loss: 0.5291 (0.5607)  time: 1.8863  data: 1.8530  max mem: 1229
Epoch: [18] Total time: 0:01:28 (1.8763 s / it)
Averaged stats: lr: 0.000059  loss: 0.5291 (0.5607)
/home/qingchan/project/deit_smh/deit_smh/engine.py:137: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast():
Test:  [ 0/14]  eta: 0:00:49  loss: 0.2864 (0.2864)  acc1: 91.6667 (91.6667)  acc5: 100.0000 (100.0000)  time: 3.5160  data: 3.5029  max mem: 1229
Test:  [10/14]  eta: 0:00:15  loss: 0.3028 (0.3040)  acc1: 90.6250 (91.3826)  acc5: 100.0000 (100.0000)  time: 3.8364  data: 3.8233  max mem: 1229
Test:  [13/14]  eta: 0:00:03  loss: 0.2966 (0.3023)  acc1: 90.6250 (91.4550)  acc5: 100.0000 (100.0000)  time: 3.7104  data: 3.6977  max mem: 1229
Test: Total time: 0:00:51 (3.7105 s / it)
* Acc@1 91.455 Acc@5 100.000 loss 0.302
Accuracy of the network on the 1299 test images: 91.5%
Max accuracy: 91.99%
/home/qingchan/project/deit_smh/deit_smh/engine.py:86: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast():
Epoch: [19]  [ 0/47]  eta: 0:01:46  lr: 0.000058  loss: 0.5880 (0.5880)  time: 2.2591  data: 2.2253  max mem: 1229
Epoch: [19]  [10/47]  eta: 0:01:09  lr: 0.000058  loss: 0.5860 (0.5847)  time: 1.8777  data: 1.8444  max mem: 1229
Epoch: [19]  [20/47]  eta: 0:00:50  lr: 0.000058  loss: 0.5734 (0.5745)  time: 1.8565  data: 1.8234  max mem: 1229
Epoch: [19]  [30/47]  eta: 0:00:31  lr: 0.000058  loss: 0.5386 (0.5593)  time: 1.8504  data: 1.8173  max mem: 1229
Epoch: [19]  [40/47]  eta: 0:00:13  lr: 0.000058  loss: 0.5572 (0.5606)  time: 1.8395  data: 1.8061  max mem: 1229
Epoch: [19]  [46/47]  eta: 0:00:01  lr: 0.000058  loss: 0.5562 (0.5609)  time: 1.8662  data: 1.8329  max mem: 1229
Epoch: [19] Total time: 0:01:27 (1.8598 s / it)
Averaged stats: lr: 0.000058  loss: 0.5562 (0.5609)
/home/qingchan/project/deit_smh/deit_smh/engine.py:137: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast():
Test:  [ 0/14]  eta: 0:00:55  loss: 0.2841 (0.2841)  acc1: 90.6250 (90.6250)  acc5: 100.0000 (100.0000)  time: 3.9332  data: 3.9193  max mem: 1229
Test:  [10/14]  eta: 0:00:15  loss: 0.3019 (0.3012)  acc1: 90.6250 (91.7614)  acc5: 100.0000 (100.0000)  time: 3.9450  data: 3.9319  max mem: 1229
Test:  [13/14]  eta: 0:00:03  loss: 0.2940 (0.2966)  acc1: 90.6250 (91.9938)  acc5: 100.0000 (100.0000)  time: 3.7938  data: 3.7811  max mem: 1229
Test: Total time: 0:00:53 (3.7939 s / it)
* Acc@1 91.994 Acc@5 100.000 loss 0.297
Accuracy of the network on the 1299 test images: 92.0%
Max accuracy: 91.99%
/home/qingchan/project/deit_smh/deit_smh/engine.py:86: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast():
Epoch: [20]  [ 0/47]  eta: 0:01:29  lr: 0.000058  loss: 0.5531 (0.5531)  time: 1.8954  data: 1.8631  max mem: 1229
Epoch: [20]  [10/47]  eta: 0:01:12  lr: 0.000058  loss: 0.5283 (0.5262)  time: 1.9496  data: 1.9163  max mem: 1229
Epoch: [20]  [20/47]  eta: 0:00:53  lr: 0.000058  loss: 0.5283 (0.5495)  time: 1.9751  data: 1.9419  max mem: 1229
Epoch: [20]  [30/47]  eta: 0:00:33  lr: 0.000058  loss: 0.5446 (0.5470)  time: 1.9816  data: 1.9485  max mem: 1229
Epoch: [20]  [40/47]  eta: 0:00:13  lr: 0.000058  loss: 0.5232 (0.5459)  time: 1.9816  data: 1.9489  max mem: 1229
Epoch: [20]  [46/47]  eta: 0:00:01  lr: 0.000058  loss: 0.5532 (0.5445)  time: 1.9369  data: 1.9044  max mem: 1229
Epoch: [20] Total time: 0:01:32 (1.9591 s / it)
Averaged stats: lr: 0.000058  loss: 0.5532 (0.5445)
/home/qingchan/project/deit_smh/deit_smh/engine.py:137: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast():
Test:  [ 0/14]  eta: 0:00:51  loss: 0.2550 (0.2550)  acc1: 91.6667 (91.6667)  acc5: 100.0000 (100.0000)  time: 3.6575  data: 3.6445  max mem: 1229
Test:  [10/14]  eta: 0:00:15  loss: 0.2567 (0.2607)  acc1: 92.7083 (92.5189)  acc5: 100.0000 (100.0000)  time: 3.9386  data: 3.9255  max mem: 1229
Test:  [13/14]  eta: 0:00:03  loss: 0.2550 (0.2593)  acc1: 91.6667 (92.4557)  acc5: 100.0000 (100.0000)  time: 3.7801  data: 3.7674  max mem: 1229
Test: Total time: 0:00:52 (3.7802 s / it)
* Acc@1 92.456 Acc@5 100.000 loss 0.259
Accuracy of the network on the 1299 test images: 92.5%
Max accuracy: 92.46%
/home/qingchan/project/deit_smh/deit_smh/engine.py:86: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast():
Epoch: [21]  [ 0/47]  eta: 0:01:29  lr: 0.000057  loss: 0.5683 (0.5683)  time: 1.8998  data: 1.8670  max mem: 1229
Epoch: [21]  [10/47]  eta: 0:01:11  lr: 0.000057  loss: 0.5683 (0.5806)  time: 1.9356  data: 1.9030  max mem: 1229
Epoch: [21]  [20/47]  eta: 0:00:53  lr: 0.000057  loss: 0.5511 (0.5629)  time: 1.9737  data: 1.9414  max mem: 1229
Epoch: [21]  [30/47]  eta: 0:00:33  lr: 0.000057  loss: 0.5430 (0.5546)  time: 1.9987  data: 1.9664  max mem: 1229
Epoch: [21]  [40/47]  eta: 0:00:13  lr: 0.000057  loss: 0.5574 (0.5640)  time: 1.9760  data: 1.9432  max mem: 1229
Epoch: [21]  [46/47]  eta: 0:00:01  lr: 0.000057  loss: 0.5511 (0.5622)  time: 1.9335  data: 1.9007  max mem: 1229
Epoch: [21] Total time: 0:01:32 (1.9621 s / it)
Averaged stats: lr: 0.000057  loss: 0.5511 (0.5622)
/home/qingchan/project/deit_smh/deit_smh/engine.py:137: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast():
Test:  [ 0/14]  eta: 0:00:50  loss: 0.2747 (0.2747)  acc1: 92.7083 (92.7083)  acc5: 100.0000 (100.0000)  time: 3.6117  data: 3.5986  max mem: 1229
Test:  [10/14]  eta: 0:00:15  loss: 0.2910 (0.2882)  acc1: 92.7083 (92.8030)  acc5: 100.0000 (100.0000)  time: 3.9153  data: 3.9022  max mem: 1229
Test:  [13/14]  eta: 0:00:03  loss: 0.2904 (0.2857)  acc1: 92.7083 (93.1486)  acc5: 100.0000 (100.0000)  time: 3.7554  data: 3.7428  max mem: 1229
Test: Total time: 0:00:52 (3.7555 s / it)
* Acc@1 93.149 Acc@5 100.000 loss 0.286
Accuracy of the network on the 1299 test images: 93.1%
Max accuracy: 93.15%
/home/qingchan/project/deit_smh/deit_smh/engine.py:86: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast():
Epoch: [22]  [ 0/47]  eta: 0:01:20  lr: 0.000057  loss: 0.5528 (0.5528)  time: 1.7028  data: 1.6704  max mem: 1229
Epoch: [22]  [10/47]  eta: 0:01:12  lr: 0.000057  loss: 0.5528 (0.5646)  time: 1.9465  data: 1.9128  max mem: 1229
Epoch: [22]  [20/47]  eta: 0:00:53  lr: 0.000057  loss: 0.5690 (0.5667)  time: 1.9849  data: 1.9512  max mem: 1229
Epoch: [22]  [30/47]  eta: 0:00:34  lr: 0.000057  loss: 0.5690 (0.5663)  time: 2.0431  data: 2.0095  max mem: 1229
Epoch: [22]  [40/47]  eta: 0:00:14  lr: 0.000057  loss: 0.5643 (0.5618)  time: 2.0433  data: 2.0098  max mem: 1229
Epoch: [22]  [46/47]  eta: 0:00:02  lr: 0.000057  loss: 0.5519 (0.5588)  time: 1.9933  data: 1.9600  max mem: 1229
Epoch: [22] Total time: 0:01:34 (2.0003 s / it)
Averaged stats: lr: 0.000057  loss: 0.5519 (0.5588)
/home/qingchan/project/deit_smh/deit_smh/engine.py:137: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast():
Test:  [ 0/14]  eta: 0:00:51  loss: 0.2485 (0.2485)  acc1: 92.7083 (92.7083)  acc5: 100.0000 (100.0000)  time: 3.7026  data: 3.6895  max mem: 1229
Test:  [10/14]  eta: 0:00:15  loss: 0.2558 (0.2590)  acc1: 92.7083 (93.4659)  acc5: 100.0000 (100.0000)  time: 3.9957  data: 3.9826  max mem: 1229
Test:  [13/14]  eta: 0:00:03  loss: 0.2558 (0.2589)  acc1: 92.7083 (93.6105)  acc5: 100.0000 (100.0000)  time: 3.8271  data: 3.8144  max mem: 1229
Test: Total time: 0:00:53 (3.8272 s / it)
* Acc@1 93.610 Acc@5 100.000 loss 0.259
Accuracy of the network on the 1299 test images: 93.6%
Max accuracy: 93.61%
/home/qingchan/project/deit_smh/deit_smh/engine.py:86: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast():
Epoch: [23]  [ 0/47]  eta: 0:01:37  lr: 0.000056  loss: 0.5744 (0.5744)  time: 2.0736  data: 2.0409  max mem: 1229
Epoch: [23]  [10/47]  eta: 0:01:19  lr: 0.000056  loss: 0.5530 (0.5548)  time: 2.1443  data: 2.1107  max mem: 1229
Epoch: [23]  [20/47]  eta: 0:00:55  lr: 0.000056  loss: 0.5530 (0.5616)  time: 2.0507  data: 2.0173  max mem: 1229
Epoch: [23]  [30/47]  eta: 0:00:34  lr: 0.000056  loss: 0.5712 (0.5677)  time: 1.9480  data: 1.9148  max mem: 1229
Epoch: [23]  [40/47]  eta: 0:00:13  lr: 0.000056  loss: 0.5510 (0.5606)  time: 1.9022  data: 1.8690  max mem: 1229
Epoch: [23]  [46/47]  eta: 0:00:01  lr: 0.000056  loss: 0.5510 (0.5613)  time: 1.8855  data: 1.8523  max mem: 1229
Epoch: [23] Total time: 0:01:33 (1.9806 s / it)
Averaged stats: lr: 0.000056  loss: 0.5510 (0.5613)
/home/qingchan/project/deit_smh/deit_smh/engine.py:137: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast():
Test:  [ 0/14]  eta: 0:00:53  loss: 0.2553 (0.2553)  acc1: 91.6667 (91.6667)  acc5: 100.0000 (100.0000)  time: 3.8092  data: 3.7962  max mem: 1229
Test:  [10/14]  eta: 0:00:15  loss: 0.2727 (0.2701)  acc1: 91.6667 (92.1402)  acc5: 100.0000 (100.0000)  time: 3.9402  data: 3.9272  max mem: 1229
Test:  [13/14]  eta: 0:00:03  loss: 0.2691 (0.2673)  acc1: 91.6667 (92.2248)  acc5: 100.0000 (100.0000)  time: 3.7791  data: 3.7665  max mem: 1229
Test: Total time: 0:00:52 (3.7792 s / it)
* Acc@1 92.225 Acc@5 100.000 loss 0.267
Accuracy of the network on the 1299 test images: 92.2%
Max accuracy: 93.61%
/home/qingchan/project/deit_smh/deit_smh/engine.py:86: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast():
Epoch: [24]  [ 0/47]  eta: 0:02:01  lr: 0.000056  loss: 0.6113 (0.6113)  time: 2.5872  data: 2.5547  max mem: 1229
Epoch: [24]  [10/47]  eta: 0:01:11  lr: 0.000056  loss: 0.5817 (0.5677)  time: 1.9395  data: 1.9071  max mem: 1229
Epoch: [24]  [20/47]  eta: 0:00:53  lr: 0.000056  loss: 0.5485 (0.5650)  time: 1.9456  data: 1.9129  max mem: 1229
Epoch: [24]  [30/47]  eta: 0:00:33  lr: 0.000056  loss: 0.5183 (0.5526)  time: 1.9876  data: 1.9546  max mem: 1229
Epoch: [24]  [40/47]  eta: 0:00:13  lr: 0.000056  loss: 0.5288 (0.5524)  time: 1.9567  data: 1.9229  max mem: 1229
Epoch: [24]  [46/47]  eta: 0:00:01  lr: 0.000056  loss: 0.5064 (0.5453)  time: 1.9866  data: 1.9527  max mem: 1229
Epoch: [24] Total time: 0:01:32 (1.9725 s / it)
Averaged stats: lr: 0.000056  loss: 0.5064 (0.5453)
/home/qingchan/project/deit_smh/deit_smh/engine.py:137: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast():
Test:  [ 0/14]  eta: 0:00:51  loss: 0.2600 (0.2600)  acc1: 90.6250 (90.6250)  acc5: 100.0000 (100.0000)  time: 3.6564  data: 3.6434  max mem: 1229
Test:  [10/14]  eta: 0:00:15  loss: 0.2807 (0.2736)  acc1: 90.6250 (91.6667)  acc5: 100.0000 (100.0000)  time: 3.9239  data: 3.9108  max mem: 1229
Test:  [13/14]  eta: 0:00:03  loss: 0.2761 (0.2714)  acc1: 90.6250 (91.9938)  acc5: 100.0000 (100.0000)  time: 3.8096  data: 3.7969  max mem: 1229
Test: Total time: 0:00:53 (3.8098 s / it)
* Acc@1 91.994 Acc@5 100.000 loss 0.271
Accuracy of the network on the 1299 test images: 92.0%
Max accuracy: 93.61%
/home/qingchan/project/deit_smh/deit_smh/engine.py:86: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast():
Epoch: [25]  [ 0/47]  eta: 0:01:57  lr: 0.000055  loss: 0.6321 (0.6321)  time: 2.4962  data: 2.4627  max mem: 1229
Epoch: [25]  [10/47]  eta: 0:01:18  lr: 0.000055  loss: 0.5933 (0.5940)  time: 2.1327  data: 2.0993  max mem: 1229
Epoch: [25]  [20/47]  eta: 0:00:53  lr: 0.000055  loss: 0.5849 (0.5821)  time: 1.9422  data: 1.9089  max mem: 1229
Epoch: [25]  [30/47]  eta: 0:00:33  lr: 0.000055  loss: 0.5726 (0.5786)  time: 1.8963  data: 1.8630  max mem: 1229
Epoch: [25]  [40/47]  eta: 0:00:13  lr: 0.000055  loss: 0.5581 (0.5701)  time: 1.9596  data: 1.9261  max mem: 1229
Epoch: [25]  [46/47]  eta: 0:00:01  lr: 0.000055  loss: 0.5486 (0.5692)  time: 1.9997  data: 1.9661  max mem: 1229
Epoch: [25] Total time: 0:01:32 (1.9781 s / it)
Averaged stats: lr: 0.000055  loss: 0.5486 (0.5692)
/home/qingchan/project/deit_smh/deit_smh/engine.py:137: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast():
Test:  [ 0/14]  eta: 0:00:50  loss: 0.2578 (0.2578)  acc1: 91.6667 (91.6667)  acc5: 100.0000 (100.0000)  time: 3.5946  data: 3.5815  max mem: 1229
Test:  [10/14]  eta: 0:00:15  loss: 0.2740 (0.2734)  acc1: 91.6667 (92.8030)  acc5: 100.0000 (100.0000)  time: 3.8987  data: 3.8855  max mem: 1229
Test:  [13/14]  eta: 0:00:03  loss: 0.2730 (0.2716)  acc1: 91.6667 (92.9176)  acc5: 100.0000 (100.0000)  time: 3.7415  data: 3.7287  max mem: 1229
Test: Total time: 0:00:52 (3.7416 s / it)
* Acc@1 92.918 Acc@5 100.000 loss 0.272
Accuracy of the network on the 1299 test images: 92.9%
Max accuracy: 93.61%
/home/qingchan/project/deit_smh/deit_smh/engine.py:86: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast():
Epoch: [26]  [ 0/47]  eta: 0:01:16  lr: 0.000055  loss: 0.6186 (0.6186)  time: 1.6348  data: 1.6022  max mem: 1229
Epoch: [26]  [10/47]  eta: 0:01:09  lr: 0.000055  loss: 0.5915 (0.5767)  time: 1.8801  data: 1.8473  max mem: 1229
Epoch: [26]  [20/47]  eta: 0:00:52  lr: 0.000055  loss: 0.5584 (0.5617)  time: 1.9481  data: 1.9154  max mem: 1229
Epoch: [26]  [30/47]  eta: 0:00:32  lr: 0.000055  loss: 0.5566 (0.5663)  time: 1.9418  data: 1.9088  max mem: 1229
Epoch: [26]  [40/47]  eta: 0:00:13  lr: 0.000055  loss: 0.5843 (0.5716)  time: 1.9859  data: 1.9525  max mem: 1229
Epoch: [26]  [46/47]  eta: 0:00:01  lr: 0.000055  loss: 0.5843 (0.5724)  time: 2.0106  data: 1.9773  max mem: 1229
Epoch: [26] Total time: 0:01:31 (1.9544 s / it)
Averaged stats: lr: 0.000055  loss: 0.5843 (0.5724)
/home/qingchan/project/deit_smh/deit_smh/engine.py:137: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast():
Test:  [ 0/14]  eta: 0:00:51  loss: 0.2691 (0.2691)  acc1: 91.6667 (91.6667)  acc5: 100.0000 (100.0000)  time: 3.6556  data: 3.6425  max mem: 1229
Test:  [10/14]  eta: 0:00:15  loss: 0.2864 (0.2835)  acc1: 93.7500 (93.0871)  acc5: 100.0000 (100.0000)  time: 3.8780  data: 3.8650  max mem: 1229
Test:  [13/14]  eta: 0:00:03  loss: 0.2862 (0.2823)  acc1: 93.7500 (93.3795)  acc5: 100.0000 (100.0000)  time: 3.7507  data: 3.7381  max mem: 1229
Test: Total time: 0:00:52 (3.7509 s / it)
* Acc@1 93.380 Acc@5 100.000 loss 0.282
Accuracy of the network on the 1299 test images: 93.4%
Max accuracy: 93.61%
/home/qingchan/project/deit_smh/deit_smh/engine.py:86: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast():
Epoch: [27]  [ 0/47]  eta: 0:01:37  lr: 0.000054  loss: 0.5864 (0.5864)  time: 2.0683  data: 2.0355  max mem: 1229
Epoch: [27]  [10/47]  eta: 0:01:14  lr: 0.000054  loss: 0.5664 (0.5611)  time: 2.0180  data: 1.9848  max mem: 1229
Epoch: [27]  [20/47]  eta: 0:00:53  lr: 0.000054  loss: 0.5745 (0.5655)  time: 1.9802  data: 1.9469  max mem: 1229
Epoch: [27]  [30/47]  eta: 0:00:33  lr: 0.000054  loss: 0.5708 (0.5549)  time: 1.9535  data: 1.9203  max mem: 1229
Epoch: [27]  [40/47]  eta: 0:00:13  lr: 0.000054  loss: 0.5476 (0.5482)  time: 1.9330  data: 1.8997  max mem: 1229
Epoch: [27]  [46/47]  eta: 0:00:01  lr: 0.000054  loss: 0.5528 (0.5520)  time: 1.9709  data: 1.9378  max mem: 1229
Epoch: [27] Total time: 0:01:32 (1.9628 s / it)
Averaged stats: lr: 0.000054  loss: 0.5528 (0.5520)
/home/qingchan/project/deit_smh/deit_smh/engine.py:137: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast():
Test:  [ 0/14]  eta: 0:00:50  loss: 0.2501 (0.2501)  acc1: 94.7917 (94.7917)  acc5: 100.0000 (100.0000)  time: 3.6257  data: 3.6127  max mem: 1229
Test:  [10/14]  eta: 0:00:15  loss: 0.2594 (0.2685)  acc1: 94.7917 (94.1288)  acc5: 100.0000 (100.0000)  time: 3.9217  data: 3.9086  max mem: 1229
Test:  [13/14]  eta: 0:00:03  loss: 0.2594 (0.2688)  acc1: 93.7500 (93.9184)  acc5: 100.0000 (100.0000)  time: 3.7563  data: 3.7436  max mem: 1229
Test: Total time: 0:00:52 (3.7564 s / it)
* Acc@1 93.918 Acc@5 100.000 loss 0.269
Accuracy of the network on the 1299 test images: 93.9%
Max accuracy: 93.92%
/home/qingchan/project/deit_smh/deit_smh/engine.py:86: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast():
Epoch: [28]  [ 0/47]  eta: 0:01:34  lr: 0.000054  loss: 0.5868 (0.5868)  time: 2.0144  data: 1.9821  max mem: 1229
Epoch: [28]  [10/47]  eta: 0:01:13  lr: 0.000054  loss: 0.5482 (0.5519)  time: 1.9794  data: 1.9462  max mem: 1229
Epoch: [28]  [20/47]  eta: 0:00:53  lr: 0.000054  loss: 0.5286 (0.5182)  time: 1.9705  data: 1.9372  max mem: 1229
Epoch: [28]  [30/47]  eta: 0:00:33  lr: 0.000054  loss: 0.5190 (0.5365)  time: 1.9210  data: 1.8878  max mem: 1229
Epoch: [28]  [40/47]  eta: 0:00:13  lr: 0.000054  loss: 0.5781 (0.5423)  time: 1.9290  data: 1.8960  max mem: 1229
Epoch: [28]  [46/47]  eta: 0:00:01  lr: 0.000054  loss: 0.5697 (0.5437)  time: 1.9415  data: 1.9083  max mem: 1229
Epoch: [28] Total time: 0:01:32 (1.9586 s / it)
Averaged stats: lr: 0.000054  loss: 0.5697 (0.5437)
/home/qingchan/project/deit_smh/deit_smh/engine.py:137: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast():
Test:  [ 0/14]  eta: 0:00:54  loss: 0.2923 (0.2923)  acc1: 91.6667 (91.6667)  acc5: 100.0000 (100.0000)  time: 3.8928  data: 3.8790  max mem: 1229
Test:  [10/14]  eta: 0:00:15  loss: 0.3099 (0.3066)  acc1: 90.6250 (91.2879)  acc5: 100.0000 (100.0000)  time: 3.8907  data: 3.8774  max mem: 1229
Test:  [13/14]  eta: 0:00:03  loss: 0.3060 (0.3051)  acc1: 90.6250 (91.5320)  acc5: 100.0000 (100.0000)  time: 3.7255  data: 3.7127  max mem: 1229
Test: Total time: 0:00:52 (3.7256 s / it)
* Acc@1 91.532 Acc@5 100.000 loss 0.305
Accuracy of the network on the 1299 test images: 91.5%
Max accuracy: 93.92%
/home/qingchan/project/deit_smh/deit_smh/engine.py:86: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast():
Epoch: [29]  [ 0/47]  eta: 0:01:29  lr: 0.000053  loss: 0.6149 (0.6149)  time: 1.9148  data: 1.8785  max mem: 1229
Epoch: [29]  [10/47]  eta: 0:01:16  lr: 0.000053  loss: 0.5912 (0.5729)  time: 2.0574  data: 2.0236  max mem: 1229
Epoch: [29]  [20/47]  eta: 0:00:54  lr: 0.000053  loss: 0.5261 (0.5447)  time: 2.0087  data: 1.9749  max mem: 1229
Epoch: [29]  [30/47]  eta: 0:00:33  lr: 0.000053  loss: 0.5336 (0.5481)  time: 1.9603  data: 1.9261  max mem: 1229
Epoch: [29]  [40/47]  eta: 0:00:13  lr: 0.000053  loss: 0.5336 (0.5383)  time: 1.9706  data: 1.9370  max mem: 1229
Epoch: [29]  [46/47]  eta: 0:00:01  lr: 0.000053  loss: 0.5336 (0.5410)  time: 2.0000  data: 1.9662  max mem: 1229
Epoch: [29] Total time: 0:01:33 (1.9903 s / it)
Averaged stats: lr: 0.000053  loss: 0.5336 (0.5410)
/home/qingchan/project/deit_smh/deit_smh/engine.py:137: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast():
Test:  [ 0/14]  eta: 0:00:53  loss: 0.2288 (0.2288)  acc1: 92.7083 (92.7083)  acc5: 100.0000 (100.0000)  time: 3.8255  data: 3.8125  max mem: 1229
Test:  [10/14]  eta: 0:00:15  loss: 0.2362 (0.2334)  acc1: 93.7500 (93.7500)  acc5: 100.0000 (100.0000)  time: 3.9010  data: 3.8879  max mem: 1229
Test:  [13/14]  eta: 0:00:03  loss: 0.2309 (0.2326)  acc1: 93.7500 (93.6875)  acc5: 100.0000 (100.0000)  time: 3.7368  data: 3.7241  max mem: 1229
Test: Total time: 0:00:52 (3.7369 s / it)
* Acc@1 93.687 Acc@5 100.000 loss 0.233
Accuracy of the network on the 1299 test images: 93.7%
Max accuracy: 93.92%
/home/qingchan/project/deit_smh/deit_smh/engine.py:86: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast():
Epoch: [30]  [ 0/47]  eta: 0:01:35  lr: 0.000052  loss: 0.6114 (0.6114)  time: 2.0234  data: 1.9897  max mem: 1229
Epoch: [30]  [10/47]  eta: 0:01:09  lr: 0.000052  loss: 0.5596 (0.5456)  time: 1.8801  data: 1.8470  max mem: 1229
Epoch: [30]  [20/47]  eta: 0:00:52  lr: 0.000052  loss: 0.5761 (0.5608)  time: 1.9250  data: 1.8918  max mem: 1229
Epoch: [30]  [30/47]  eta: 0:00:33  lr: 0.000052  loss: 0.5867 (0.5652)  time: 1.9905  data: 1.9573  max mem: 1229
Epoch: [30]  [40/47]  eta: 0:00:13  lr: 0.000052  loss: 0.5430 (0.5579)  time: 1.9920  data: 1.9589  max mem: 1229
Epoch: [30]  [46/47]  eta: 0:00:01  lr: 0.000052  loss: 0.5440 (0.5570)  time: 1.9333  data: 1.9002  max mem: 1229
Epoch: [30] Total time: 0:01:31 (1.9420 s / it)
Averaged stats: lr: 0.000052  loss: 0.5440 (0.5570)
/home/qingchan/project/deit_smh/deit_smh/engine.py:137: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast():
Test:  [ 0/14]  eta: 0:00:59  loss: 0.2585 (0.2585)  acc1: 93.7500 (93.7500)  acc5: 100.0000 (100.0000)  time: 4.2332  data: 4.2178  max mem: 1229
Test:  [10/14]  eta: 0:00:16  loss: 0.2702 (0.2755)  acc1: 92.7083 (93.6553)  acc5: 100.0000 (100.0000)  time: 4.0754  data: 4.0621  max mem: 1229
Test:  [13/14]  eta: 0:00:03  loss: 0.2702 (0.2761)  acc1: 92.7083 (93.5335)  acc5: 100.0000 (100.0000)  time: 3.8849  data: 3.8720  max mem: 1229
Test: Total time: 0:00:54 (3.8850 s / it)
* Acc@1 93.533 Acc@5 100.000 loss 0.276
Accuracy of the network on the 1299 test images: 93.5%
Max accuracy: 93.92%
/home/qingchan/project/deit_smh/deit_smh/engine.py:86: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast():
Epoch: [31]  [ 0/47]  eta: 0:01:34  lr: 0.000052  loss: 0.5482 (0.5482)  time: 2.0092  data: 1.9768  max mem: 1229
Epoch: [31]  [10/47]  eta: 0:01:13  lr: 0.000052  loss: 0.5482 (0.5547)  time: 1.9845  data: 1.9511  max mem: 1229
Epoch: [31]  [20/47]  eta: 0:00:53  lr: 0.000052  loss: 0.5739 (0.5530)  time: 1.9955  data: 1.9622  max mem: 1229
Epoch: [31]  [30/47]  eta: 0:00:33  lr: 0.000052  loss: 0.5485 (0.5541)  time: 2.0064  data: 1.9730  max mem: 1229
Epoch: [31]  [40/47]  eta: 0:00:13  lr: 0.000052  loss: 0.5485 (0.5532)  time: 1.9789  data: 1.9455  max mem: 1229
Epoch: [31]  [46/47]  eta: 0:00:01  lr: 0.000052  loss: 0.5425 (0.5524)  time: 1.9407  data: 1.9075  max mem: 1229
Epoch: [31] Total time: 0:01:33 (1.9831 s / it)
Averaged stats: lr: 0.000052  loss: 0.5425 (0.5524)
/home/qingchan/project/deit_smh/deit_smh/engine.py:137: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast():
Test:  [ 0/14]  eta: 0:00:49  loss: 0.2698 (0.2698)  acc1: 91.6667 (91.6667)  acc5: 100.0000 (100.0000)  time: 3.5603  data: 3.5472  max mem: 1229
Test:  [10/14]  eta: 0:00:15  loss: 0.2897 (0.2794)  acc1: 91.6667 (92.3295)  acc5: 100.0000 (100.0000)  time: 3.8922  data: 3.8791  max mem: 1229
Test:  [13/14]  eta: 0:00:03  loss: 0.2833 (0.2785)  acc1: 91.6667 (92.4557)  acc5: 100.0000 (100.0000)  time: 3.7281  data: 3.7154  max mem: 1229
Test: Total time: 0:00:52 (3.7282 s / it)
* Acc@1 92.456 Acc@5 100.000 loss 0.278
Accuracy of the network on the 1299 test images: 92.5%
Max accuracy: 93.92%
/home/qingchan/project/deit_smh/deit_smh/engine.py:86: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast():
Epoch: [32]  [ 0/47]  eta: 0:01:50  lr: 0.000051  loss: 0.4805 (0.4805)  time: 2.3471  data: 2.3128  max mem: 1229
Epoch: [32]  [10/47]  eta: 0:01:18  lr: 0.000051  loss: 0.5814 (0.5700)  time: 2.1126  data: 2.0792  max mem: 1229
Epoch: [32]  [20/47]  eta: 0:00:54  lr: 0.000051  loss: 0.5365 (0.5485)  time: 1.9848  data: 1.9516  max mem: 1229
Epoch: [32]  [30/47]  eta: 0:00:33  lr: 0.000051  loss: 0.5193 (0.5534)  time: 1.8956  data: 1.8624  max mem: 1229
Epoch: [32]  [40/47]  eta: 0:00:13  lr: 0.000051  loss: 0.5023 (0.5396)  time: 1.9464  data: 1.9132  max mem: 1229
Epoch: [32]  [46/47]  eta: 0:00:01  lr: 0.000051  loss: 0.5023 (0.5382)  time: 1.9378  data: 1.9046  max mem: 1229
Epoch: [32] Total time: 0:01:32 (1.9706 s / it)
Averaged stats: lr: 0.000051  loss: 0.5023 (0.5382)
/home/qingchan/project/deit_smh/deit_smh/engine.py:137: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast():
Test:  [ 0/14]  eta: 0:00:50  loss: 0.2056 (0.2056)  acc1: 95.8333 (95.8333)  acc5: 100.0000 (100.0000)  time: 3.6049  data: 3.5919  max mem: 1229
Test:  [10/14]  eta: 0:00:15  loss: 0.2212 (0.2187)  acc1: 93.7500 (94.1288)  acc5: 100.0000 (100.0000)  time: 3.8985  data: 3.8854  max mem: 1229
Test:  [13/14]  eta: 0:00:03  loss: 0.2204 (0.2185)  acc1: 93.7500 (94.2263)  acc5: 100.0000 (100.0000)  time: 3.7392  data: 3.7265  max mem: 1229
Test: Total time: 0:00:52 (3.7393 s / it)
* Acc@1 94.226 Acc@5 100.000 loss 0.219
Accuracy of the network on the 1299 test images: 94.2%
Max accuracy: 94.23%
/home/qingchan/project/deit_smh/deit_smh/engine.py:86: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast():
Epoch: [33]  [ 0/47]  eta: 0:01:29  lr: 0.000050  loss: 0.6622 (0.6622)  time: 1.8957  data: 1.8634  max mem: 1229
Epoch: [33]  [10/47]  eta: 0:01:12  lr: 0.000050  loss: 0.5515 (0.5459)  time: 1.9520  data: 1.9189  max mem: 1229
Epoch: [33]  [20/47]  eta: 0:00:52  lr: 0.000050  loss: 0.5641 (0.5646)  time: 1.9493  data: 1.9161  max mem: 1229
Epoch: [33]  [30/47]  eta: 0:00:33  lr: 0.000050  loss: 0.5611 (0.5591)  time: 1.9612  data: 1.9277  max mem: 1229
Epoch: [33]  [40/47]  eta: 0:00:13  lr: 0.000050  loss: 0.5293 (0.5538)  time: 1.9792  data: 1.9458  max mem: 1229
Epoch: [33]  [46/47]  eta: 0:00:01  lr: 0.000050  loss: 0.5269 (0.5537)  time: 1.9455  data: 1.9123  max mem: 1229
Epoch: [33] Total time: 0:01:32 (1.9653 s / it)
Averaged stats: lr: 0.000050  loss: 0.5269 (0.5537)
/home/qingchan/project/deit_smh/deit_smh/engine.py:137: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast():
Test:  [ 0/14]  eta: 0:00:49  loss: 0.2470 (0.2470)  acc1: 93.7500 (93.7500)  acc5: 100.0000 (100.0000)  time: 3.5618  data: 3.5487  max mem: 1229
Test:  [10/14]  eta: 0:00:15  loss: 0.2614 (0.2600)  acc1: 93.7500 (94.0341)  acc5: 100.0000 (100.0000)  time: 3.8235  data: 3.8105  max mem: 1229
Test:  [13/14]  eta: 0:00:03  loss: 0.2607 (0.2602)  acc1: 93.7500 (93.9954)  acc5: 100.0000 (100.0000)  time: 3.7026  data: 3.6899  max mem: 1229
Test: Total time: 0:00:51 (3.7028 s / it)
* Acc@1 93.995 Acc@5 100.000 loss 0.260
Accuracy of the network on the 1299 test images: 94.0%
Max accuracy: 94.23%
/home/qingchan/project/deit_smh/deit_smh/engine.py:86: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast():
Epoch: [34]  [ 0/47]  eta: 0:01:35  lr: 0.000050  loss: 0.4884 (0.4884)  time: 2.0222  data: 1.9893  max mem: 1229
Epoch: [34]  [10/47]  eta: 0:01:11  lr: 0.000050  loss: 0.5178 (0.5223)  time: 1.9194  data: 1.8862  max mem: 1229
Epoch: [34]  [20/47]  eta: 0:00:53  lr: 0.000050  loss: 0.5301 (0.5287)  time: 1.9797  data: 1.9465  max mem: 1229
Epoch: [34]  [30/47]  eta: 0:00:32  lr: 0.000050  loss: 0.4932 (0.5064)  time: 1.9377  data: 1.9043  max mem: 1229
Epoch: [34]  [40/47]  eta: 0:00:13  lr: 0.000050  loss: 0.5021 (0.5192)  time: 1.9296  data: 1.8962  max mem: 1229
Epoch: [34]  [46/47]  eta: 0:00:01  lr: 0.000050  loss: 0.5382 (0.5253)  time: 1.9529  data: 1.9197  max mem: 1229
Epoch: [34] Total time: 0:01:32 (1.9621 s / it)
Averaged stats: lr: 0.000050  loss: 0.5382 (0.5253)
/home/qingchan/project/deit_smh/deit_smh/engine.py:137: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast():
Test:  [ 0/14]  eta: 0:00:50  loss: 0.2625 (0.2625)  acc1: 93.7500 (93.7500)  acc5: 100.0000 (100.0000)  time: 3.5855  data: 3.5725  max mem: 1229
Test:  [10/14]  eta: 0:00:15  loss: 0.2697 (0.2682)  acc1: 94.7917 (94.0341)  acc5: 100.0000 (100.0000)  time: 3.9092  data: 3.8962  max mem: 1229
Test:  [13/14]  eta: 0:00:03  loss: 0.2642 (0.2675)  acc1: 93.7500 (93.9954)  acc5: 100.0000 (100.0000)  time: 3.7482  data: 3.7356  max mem: 1229
Test: Total time: 0:00:52 (3.7483 s / it)
* Acc@1 93.995 Acc@5 100.000 loss 0.268
Accuracy of the network on the 1299 test images: 94.0%
Max accuracy: 94.23%
/home/qingchan/project/deit_smh/deit_smh/engine.py:86: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast():
Epoch: [35]  [ 0/47]  eta: 0:01:35  lr: 0.000049  loss: 0.6669 (0.6669)  time: 2.0290  data: 1.9956  max mem: 1229
Epoch: [35]  [10/47]  eta: 0:01:10  lr: 0.000049  loss: 0.5371 (0.5387)  time: 1.9153  data: 1.8823  max mem: 1229
Epoch: [35]  [20/47]  eta: 0:00:52  lr: 0.000049  loss: 0.5371 (0.5471)  time: 1.9328  data: 1.9000  max mem: 1229
Epoch: [35]  [30/47]  eta: 0:00:33  lr: 0.000049  loss: 0.5556 (0.5481)  time: 2.0348  data: 2.0017  max mem: 1229
Epoch: [35]  [40/47]  eta: 0:00:14  lr: 0.000049  loss: 0.5556 (0.5530)  time: 2.1189  data: 2.0854  max mem: 1229
Epoch: [35]  [46/47]  eta: 0:00:02  lr: 0.000049  loss: 0.5521 (0.5514)  time: 2.0132  data: 1.9798  max mem: 1229
Epoch: [35] Total time: 0:01:35 (2.0222 s / it)
Averaged stats: lr: 0.000049  loss: 0.5521 (0.5514)
/home/qingchan/project/deit_smh/deit_smh/engine.py:137: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast():
Test:  [ 0/14]  eta: 0:00:51  loss: 0.2406 (0.2406)  acc1: 95.8333 (95.8333)  acc5: 100.0000 (100.0000)  time: 3.6460  data: 3.6329  max mem: 1229
Test:  [10/14]  eta: 0:00:15  loss: 0.2485 (0.2490)  acc1: 95.8333 (94.9811)  acc5: 100.0000 (100.0000)  time: 3.8821  data: 3.8691  max mem: 1229
Test:  [13/14]  eta: 0:00:03  loss: 0.2485 (0.2499)  acc1: 95.8333 (95.1501)  acc5: 100.0000 (100.0000)  time: 3.7291  data: 3.7165  max mem: 1229
Test: Total time: 0:00:52 (3.7292 s / it)
* Acc@1 95.150 Acc@5 100.000 loss 0.250
Accuracy of the network on the 1299 test images: 95.2%
Max accuracy: 95.15%
/home/qingchan/project/deit_smh/deit_smh/engine.py:86: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast():
Epoch: [36]  [ 0/47]  eta: 0:01:31  lr: 0.000048  loss: 0.6294 (0.6294)  time: 1.9573  data: 1.9242  max mem: 1229
Epoch: [36]  [10/47]  eta: 0:01:13  lr: 0.000048  loss: 0.5387 (0.5204)  time: 1.9766  data: 1.9436  max mem: 1229
Epoch: [36]  [20/47]  eta: 0:00:52  lr: 0.000048  loss: 0.5489 (0.5356)  time: 1.9488  data: 1.9156  max mem: 1229
Epoch: [36]  [30/47]  eta: 0:00:33  lr: 0.000048  loss: 0.5580 (0.5458)  time: 1.9246  data: 1.8913  max mem: 1229
Epoch: [36]  [40/47]  eta: 0:00:13  lr: 0.000048  loss: 0.5580 (0.5407)  time: 1.9951  data: 1.9618  max mem: 1229
Epoch: [36]  [46/47]  eta: 0:00:01  lr: 0.000048  loss: 0.5381 (0.5384)  time: 2.0105  data: 1.9771  max mem: 1229
Epoch: [36] Total time: 0:01:32 (1.9680 s / it)
Averaged stats: lr: 0.000048  loss: 0.5381 (0.5384)
/home/qingchan/project/deit_smh/deit_smh/engine.py:137: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast():
Test:  [ 0/14]  eta: 0:00:51  loss: 0.2246 (0.2246)  acc1: 93.7500 (93.7500)  acc5: 100.0000 (100.0000)  time: 3.6960  data: 3.6829  max mem: 1229
Test:  [10/14]  eta: 0:00:15  loss: 0.2247 (0.2294)  acc1: 94.7917 (94.7917)  acc5: 100.0000 (100.0000)  time: 3.9973  data: 3.9843  max mem: 1229
Test:  [13/14]  eta: 0:00:03  loss: 0.2246 (0.2279)  acc1: 94.7917 (94.7652)  acc5: 100.0000 (100.0000)  time: 3.8334  data: 3.8208  max mem: 1229
Test: Total time: 0:00:53 (3.8336 s / it)
* Acc@1 94.765 Acc@5 100.000 loss 0.228
Accuracy of the network on the 1299 test images: 94.8%
Max accuracy: 95.15%
/home/qingchan/project/deit_smh/deit_smh/engine.py:86: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast():
Epoch: [37]  [ 0/47]  eta: 0:01:51  lr: 0.000047  loss: 0.4908 (0.4908)  time: 2.3806  data: 2.3483  max mem: 1229
Epoch: [37]  [10/47]  eta: 0:01:13  lr: 0.000047  loss: 0.4797 (0.4877)  time: 1.9994  data: 1.9668  max mem: 1229
Epoch: [37]  [20/47]  eta: 0:00:53  lr: 0.000047  loss: 0.4797 (0.5046)  time: 1.9663  data: 1.9334  max mem: 1229
Epoch: [37]  [30/47]  eta: 0:00:34  lr: 0.000047  loss: 0.5537 (0.5196)  time: 2.0105  data: 1.9774  max mem: 1229
Epoch: [37]  [40/47]  eta: 0:00:13  lr: 0.000047  loss: 0.5255 (0.5188)  time: 2.0077  data: 1.9746  max mem: 1229
Epoch: [37]  [46/47]  eta: 0:00:01  lr: 0.000047  loss: 0.5535 (0.5276)  time: 1.9809  data: 1.9477  max mem: 1229
Epoch: [37] Total time: 0:01:33 (1.9897 s / it)
Averaged stats: lr: 0.000047  loss: 0.5535 (0.5276)
/home/qingchan/project/deit_smh/deit_smh/engine.py:137: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast():
Test:  [ 0/14]  eta: 0:00:51  loss: 0.2249 (0.2249)  acc1: 93.7500 (93.7500)  acc5: 100.0000 (100.0000)  time: 3.6827  data: 3.6697  max mem: 1229
Test:  [10/14]  eta: 0:00:15  loss: 0.2350 (0.2370)  acc1: 95.8333 (95.3599)  acc5: 100.0000 (100.0000)  time: 3.9547  data: 3.9416  max mem: 1229
Test:  [13/14]  eta: 0:00:03  loss: 0.2302 (0.2345)  acc1: 95.8333 (95.6120)  acc5: 100.0000 (100.0000)  time: 3.7925  data: 3.7799  max mem: 1229
Test: Total time: 0:00:53 (3.7926 s / it)
* Acc@1 95.612 Acc@5 100.000 loss 0.235
Accuracy of the network on the 1299 test images: 95.6%
Max accuracy: 95.61%
/home/qingchan/project/deit_smh/deit_smh/engine.py:86: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast():
Epoch: [38]  [ 0/47]  eta: 0:01:21  lr: 0.000047  loss: 0.5123 (0.5123)  time: 1.7248  data: 1.6926  max mem: 1229
Epoch: [38]  [10/47]  eta: 0:01:14  lr: 0.000047  loss: 0.5123 (0.5168)  time: 2.0026  data: 1.9691  max mem: 1229
Epoch: [38]  [20/47]  eta: 0:00:54  lr: 0.000047  loss: 0.5180 (0.5137)  time: 2.0479  data: 2.0145  max mem: 1229
Epoch: [38]  [30/47]  eta: 0:00:34  lr: 0.000047  loss: 0.5204 (0.5175)  time: 2.0470  data: 2.0136  max mem: 1229
Epoch: [38]  [40/47]  eta: 0:00:13  lr: 0.000047  loss: 0.5229 (0.5212)  time: 1.9596  data: 1.9261  max mem: 1229
Epoch: [38]  [46/47]  eta: 0:00:02  lr: 0.000047  loss: 0.5336 (0.5264)  time: 1.9669  data: 1.9337  max mem: 1229
Epoch: [38] Total time: 0:01:34 (2.0029 s / it)
Averaged stats: lr: 0.000047  loss: 0.5336 (0.5264)
/home/qingchan/project/deit_smh/deit_smh/engine.py:137: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast():
Test:  [ 0/14]  eta: 0:00:52  loss: 0.2475 (0.2475)  acc1: 95.8333 (95.8333)  acc5: 100.0000 (100.0000)  time: 3.7606  data: 3.7474  max mem: 1229
Test:  [10/14]  eta: 0:00:16  loss: 0.2485 (0.2540)  acc1: 96.8750 (95.4545)  acc5: 100.0000 (100.0000)  time: 4.0388  data: 4.0258  max mem: 1229
Test:  [13/14]  eta: 0:00:03  loss: 0.2485 (0.2531)  acc1: 95.8333 (95.5350)  acc5: 100.0000 (100.0000)  time: 3.8557  data: 3.8431  max mem: 1229
Test: Total time: 0:00:53 (3.8558 s / it)
* Acc@1 95.535 Acc@5 100.000 loss 0.253
Accuracy of the network on the 1299 test images: 95.5%
Max accuracy: 95.61%
/home/qingchan/project/deit_smh/deit_smh/engine.py:86: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast():
Epoch: [39]  [ 0/47]  eta: 0:01:31  lr: 0.000046  loss: 0.5680 (0.5680)  time: 1.9488  data: 1.9165  max mem: 1229
Epoch: [39]  [10/47]  eta: 0:01:17  lr: 0.000046  loss: 0.5680 (0.5583)  time: 2.1032  data: 2.0694  max mem: 1229
Epoch: [39]  [20/47]  eta: 0:00:57  lr: 0.000046  loss: 0.5494 (0.5427)  time: 2.1261  data: 2.0922  max mem: 1229
Epoch: [39]  [30/47]  eta: 0:00:35  lr: 0.000046  loss: 0.5405 (0.5390)  time: 2.0963  data: 2.0623  max mem: 1229
Epoch: [39]  [40/47]  eta: 0:00:14  lr: 0.000046  loss: 0.4854 (0.5292)  time: 1.9935  data: 1.9597  max mem: 1229
Epoch: [39]  [46/47]  eta: 0:00:02  lr: 0.000046  loss: 0.4982 (0.5314)  time: 1.9936  data: 1.9600  max mem: 1229
Epoch: [39] Total time: 0:01:36 (2.0463 s / it)
Averaged stats: lr: 0.000046  loss: 0.4982 (0.5314)
/home/qingchan/project/deit_smh/deit_smh/engine.py:137: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast():
Test:  [ 0/14]  eta: 0:00:51  loss: 0.2288 (0.2288)  acc1: 95.8333 (95.8333)  acc5: 100.0000 (100.0000)  time: 3.6996  data: 3.6865  max mem: 1229
Test:  [10/14]  eta: 0:00:16  loss: 0.2409 (0.2377)  acc1: 95.8333 (95.1705)  acc5: 100.0000 (100.0000)  time: 4.0633  data: 4.0502  max mem: 1229
Test:  [13/14]  eta: 0:00:03  loss: 0.2317 (0.2366)  acc1: 95.8333 (95.3811)  acc5: 100.0000 (100.0000)  time: 3.9008  data: 3.8881  max mem: 1229
Test: Total time: 0:00:54 (3.9009 s / it)
* Acc@1 95.381 Acc@5 100.000 loss 0.237
Accuracy of the network on the 1299 test images: 95.4%
Max accuracy: 95.61%
/home/qingchan/project/deit_smh/deit_smh/engine.py:86: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast():
Epoch: [40]  [ 0/47]  eta: 0:01:36  lr: 0.000045  loss: 0.6030 (0.6030)  time: 2.0471  data: 2.0111  max mem: 1229
Epoch: [40]  [10/47]  eta: 0:01:14  lr: 0.000045  loss: 0.5363 (0.5502)  time: 2.0031  data: 1.9695  max mem: 1229
Epoch: [40]  [20/47]  eta: 0:00:53  lr: 0.000045  loss: 0.5362 (0.5543)  time: 1.9870  data: 1.9537  max mem: 1229
Epoch: [40]  [30/47]  eta: 0:00:34  lr: 0.000045  loss: 0.5325 (0.5483)  time: 2.0048  data: 1.9714  max mem: 1229
Epoch: [40]  [40/47]  eta: 0:00:13  lr: 0.000045  loss: 0.5595 (0.5498)  time: 2.0102  data: 1.9768  max mem: 1229
Epoch: [40]  [46/47]  eta: 0:00:02  lr: 0.000045  loss: 0.5606 (0.5492)  time: 1.9841  data: 1.9508  max mem: 1229
Epoch: [40] Total time: 0:01:34 (2.0031 s / it)
Averaged stats: lr: 0.000045  loss: 0.5606 (0.5492)
/home/qingchan/project/deit_smh/deit_smh/engine.py:137: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast():
Test:  [ 0/14]  eta: 0:00:52  loss: 0.2210 (0.2210)  acc1: 94.7917 (94.7917)  acc5: 100.0000 (100.0000)  time: 3.7827  data: 3.7687  max mem: 1229
Test:  [10/14]  eta: 0:00:15  loss: 0.2210 (0.2230)  acc1: 94.7917 (94.8864)  acc5: 100.0000 (100.0000)  time: 3.9377  data: 3.9245  max mem: 1229
Test:  [13/14]  eta: 0:00:03  loss: 0.2210 (0.2236)  acc1: 94.7917 (95.0731)  acc5: 100.0000 (100.0000)  time: 3.7813  data: 3.7686  max mem: 1229
Test: Total time: 0:00:52 (3.7814 s / it)
* Acc@1 95.073 Acc@5 100.000 loss 0.224
Accuracy of the network on the 1299 test images: 95.1%
Max accuracy: 95.61%
/home/qingchan/project/deit_smh/deit_smh/engine.py:86: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast():
Epoch: [41]  [ 0/47]  eta: 0:01:25  lr: 0.000044  loss: 0.4961 (0.4961)  time: 1.8208  data: 1.7879  max mem: 1229
Epoch: [41]  [10/47]  eta: 0:01:12  lr: 0.000044  loss: 0.5395 (0.5352)  time: 1.9526  data: 1.9196  max mem: 1229
Epoch: [41]  [20/47]  eta: 0:00:52  lr: 0.000044  loss: 0.5285 (0.5365)  time: 1.9339  data: 1.9009  max mem: 1229
Epoch: [41]  [30/47]  eta: 0:00:33  lr: 0.000044  loss: 0.5181 (0.5359)  time: 1.9460  data: 1.9130  max mem: 1229
Epoch: [41]  [40/47]  eta: 0:00:13  lr: 0.000044  loss: 0.5181 (0.5336)  time: 2.0085  data: 1.9754  max mem: 1229
Epoch: [41]  [46/47]  eta: 0:00:01  lr: 0.000044  loss: 0.5163 (0.5305)  time: 2.0510  data: 2.0176  max mem: 1229
Epoch: [41] Total time: 0:01:33 (1.9849 s / it)
Averaged stats: lr: 0.000044  loss: 0.5163 (0.5305)
/home/qingchan/project/deit_smh/deit_smh/engine.py:137: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast():
Test:  [ 0/14]  eta: 0:00:50  loss: 0.2134 (0.2134)  acc1: 94.7917 (94.7917)  acc5: 100.0000 (100.0000)  time: 3.6043  data: 3.5912  max mem: 1229
Test:  [10/14]  eta: 0:00:15  loss: 0.2173 (0.2184)  acc1: 96.8750 (95.3599)  acc5: 100.0000 (100.0000)  time: 3.8655  data: 3.8524  max mem: 1229
Test:  [13/14]  eta: 0:00:03  loss: 0.2173 (0.2166)  acc1: 96.0784 (95.4580)  acc5: 100.0000 (100.0000)  time: 3.7086  data: 3.6960  max mem: 1229
Test: Total time: 0:00:51 (3.7087 s / it)
* Acc@1 95.458 Acc@5 100.000 loss 0.217
Accuracy of the network on the 1299 test images: 95.5%
Max accuracy: 95.61%
/home/qingchan/project/deit_smh/deit_smh/engine.py:86: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast():
Epoch: [42]  [ 0/47]  eta: 0:01:30  lr: 0.000044  loss: 0.5121 (0.5121)  time: 1.9194  data: 1.8867  max mem: 1229
Epoch: [42]  [10/47]  eta: 0:01:13  lr: 0.000044  loss: 0.5129 (0.5186)  time: 1.9954  data: 1.9622  max mem: 1229
Epoch: [42]  [20/47]  eta: 0:00:53  lr: 0.000044  loss: 0.5429 (0.5436)  time: 1.9997  data: 1.9666  max mem: 1229
Epoch: [42]  [30/47]  eta: 0:00:33  lr: 0.000044  loss: 0.5898 (0.5530)  time: 1.9538  data: 1.9204  max mem: 1229
Epoch: [42]  [40/47]  eta: 0:00:13  lr: 0.000044  loss: 0.5365 (0.5435)  time: 1.9047  data: 1.8713  max mem: 1229
Epoch: [42]  [46/47]  eta: 0:00:01  lr: 0.000044  loss: 0.5365 (0.5423)  time: 1.9086  data: 1.8751  max mem: 1229
Epoch: [42] Total time: 0:01:31 (1.9556 s / it)
Averaged stats: lr: 0.000044  loss: 0.5365 (0.5423)
/home/qingchan/project/deit_smh/deit_smh/engine.py:137: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast():
Test:  [ 0/14]  eta: 0:00:55  loss: 0.2098 (0.2098)  acc1: 95.8333 (95.8333)  acc5: 100.0000 (100.0000)  time: 3.9600  data: 3.9470  max mem: 1229
Test:  [10/14]  eta: 0:00:15  loss: 0.2174 (0.2184)  acc1: 95.8333 (95.6439)  acc5: 100.0000 (100.0000)  time: 3.8576  data: 3.8445  max mem: 1229
Test:  [13/14]  eta: 0:00:03  loss: 0.2174 (0.2181)  acc1: 95.8333 (95.6890)  acc5: 100.0000 (100.0000)  time: 3.7111  data: 3.6984  max mem: 1229
Test: Total time: 0:00:51 (3.7112 s / it)
* Acc@1 95.689 Acc@5 100.000 loss 0.218
Accuracy of the network on the 1299 test images: 95.7%
Max accuracy: 95.69%
/home/qingchan/project/deit_smh/deit_smh/engine.py:86: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast():
Epoch: [43]  [ 0/47]  eta: 0:01:20  lr: 0.000043  loss: 0.6181 (0.6181)  time: 1.7035  data: 1.6706  max mem: 1229
Epoch: [43]  [10/47]  eta: 0:01:09  lr: 0.000043  loss: 0.5457 (0.5477)  time: 1.8701  data: 1.8373  max mem: 1229
Epoch: [43]  [20/47]  eta: 0:00:52  lr: 0.000043  loss: 0.5401 (0.5464)  time: 1.9516  data: 1.9183  max mem: 1229
Epoch: [43]  [30/47]  eta: 0:00:32  lr: 0.000043  loss: 0.5259 (0.5394)  time: 1.9566  data: 1.9231  max mem: 1229
Epoch: [43]  [40/47]  eta: 0:00:13  lr: 0.000043  loss: 0.5070 (0.5287)  time: 1.9683  data: 1.9351  max mem: 1229
Epoch: [43]  [46/47]  eta: 0:00:01  lr: 0.000043  loss: 0.4997 (0.5225)  time: 1.9754  data: 1.9421  max mem: 1229
Epoch: [43] Total time: 0:01:31 (1.9527 s / it)
Averaged stats: lr: 0.000043  loss: 0.4997 (0.5225)
/home/qingchan/project/deit_smh/deit_smh/engine.py:137: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast():
Test:  [ 0/14]  eta: 0:00:51  loss: 0.2023 (0.2023)  acc1: 96.8750 (96.8750)  acc5: 100.0000 (100.0000)  time: 3.6694  data: 3.6564  max mem: 1229
Test:  [10/14]  eta: 0:00:15  loss: 0.2105 (0.2098)  acc1: 96.8750 (95.6439)  acc5: 100.0000 (100.0000)  time: 3.9845  data: 3.9715  max mem: 1229
Test:  [13/14]  eta: 0:00:03  loss: 0.2105 (0.2102)  acc1: 96.8750 (95.6890)  acc5: 100.0000 (100.0000)  time: 3.8169  data: 3.8043  max mem: 1229
Test: Total time: 0:00:53 (3.8170 s / it)
* Acc@1 95.689 Acc@5 100.000 loss 0.210
Accuracy of the network on the 1299 test images: 95.7%
Max accuracy: 95.69%
/home/qingchan/project/deit_smh/deit_smh/engine.py:86: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast():
Epoch: [44]  [ 0/47]  eta: 0:01:40  lr: 0.000042  loss: 0.5222 (0.5222)  time: 2.1313  data: 2.0994  max mem: 1229
Epoch: [44]  [10/47]  eta: 0:01:17  lr: 0.000042  loss: 0.4481 (0.4793)  time: 2.0812  data: 2.0476  max mem: 1229
Epoch: [44]  [20/47]  eta: 0:00:55  lr: 0.000042  loss: 0.5163 (0.5010)  time: 2.0481  data: 2.0147  max mem: 1229
Epoch: [44]  [30/47]  eta: 0:00:33  lr: 0.000042  loss: 0.5318 (0.5148)  time: 1.9456  data: 1.9123  max mem: 1229
Epoch: [44]  [40/47]  eta: 0:00:13  lr: 0.000042  loss: 0.5379 (0.5269)  time: 1.8638  data: 1.8303  max mem: 1229
Epoch: [44]  [46/47]  eta: 0:00:01  lr: 0.000042  loss: 0.5497 (0.5328)  time: 1.9052  data: 1.8719  max mem: 1229
Epoch: [44] Total time: 0:01:32 (1.9636 s / it)
Averaged stats: lr: 0.000042  loss: 0.5497 (0.5328)
/home/qingchan/project/deit_smh/deit_smh/engine.py:137: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast():
Test:  [ 0/14]  eta: 0:00:50  loss: 0.2209 (0.2209)  acc1: 96.8750 (96.8750)  acc5: 100.0000 (100.0000)  time: 3.6370  data: 3.6239  max mem: 1229
Test:  [10/14]  eta: 0:00:15  loss: 0.2255 (0.2280)  acc1: 96.8750 (96.0227)  acc5: 100.0000 (100.0000)  time: 3.9212  data: 3.9082  max mem: 1229
Test:  [13/14]  eta: 0:00:03  loss: 0.2255 (0.2271)  acc1: 96.8750 (96.3049)  acc5: 100.0000 (100.0000)  time: 3.7709  data: 3.7582  max mem: 1229
Test: Total time: 0:00:52 (3.7710 s / it)
* Acc@1 96.305 Acc@5 100.000 loss 0.227
Accuracy of the network on the 1299 test images: 96.3%
Max accuracy: 96.30%
/home/qingchan/project/deit_smh/deit_smh/engine.py:86: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast():
Epoch: [45]  [ 0/47]  eta: 0:01:55  lr: 0.000041  loss: 0.5769 (0.5769)  time: 2.4521  data: 2.4196  max mem: 1229
Epoch: [45]  [10/47]  eta: 0:01:18  lr: 0.000041  loss: 0.5378 (0.5475)  time: 2.1270  data: 2.0933  max mem: 1229
Epoch: [45]  [20/47]  eta: 0:00:54  lr: 0.000041  loss: 0.5378 (0.5494)  time: 1.9964  data: 1.9627  max mem: 1229
Epoch: [45]  [30/47]  eta: 0:00:33  lr: 0.000041  loss: 0.5599 (0.5606)  time: 1.8947  data: 1.8613  max mem: 1229
Epoch: [45]  [40/47]  eta: 0:00:13  lr: 0.000041  loss: 0.5490 (0.5461)  time: 1.9064  data: 1.8728  max mem: 1229
Epoch: [45]  [46/47]  eta: 0:00:01  lr: 0.000041  loss: 0.5505 (0.5537)  time: 1.9456  data: 1.9124  max mem: 1229
Epoch: [45] Total time: 0:01:33 (1.9844 s / it)
Averaged stats: lr: 0.000041  loss: 0.5505 (0.5537)
/home/qingchan/project/deit_smh/deit_smh/engine.py:137: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast():
Test:  [ 0/14]  eta: 0:00:51  loss: 0.2201 (0.2201)  acc1: 94.7917 (94.7917)  acc5: 100.0000 (100.0000)  time: 3.7024  data: 3.6893  max mem: 1229
Test:  [10/14]  eta: 0:00:15  loss: 0.2234 (0.2279)  acc1: 96.8750 (95.4545)  acc5: 100.0000 (100.0000)  time: 3.9673  data: 3.9542  max mem: 1229
Test:  [13/14]  eta: 0:00:03  loss: 0.2234 (0.2267)  acc1: 95.8333 (95.3041)  acc5: 100.0000 (100.0000)  time: 3.8070  data: 3.7944  max mem: 1229
Test: Total time: 0:00:53 (3.8072 s / it)
* Acc@1 95.304 Acc@5 100.000 loss 0.227
Accuracy of the network on the 1299 test images: 95.3%
Max accuracy: 96.30%
/home/qingchan/project/deit_smh/deit_smh/engine.py:86: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast():
Epoch: [46]  [ 0/47]  eta: 0:01:37  lr: 0.000040  loss: 0.6727 (0.6727)  time: 2.0716  data: 2.0391  max mem: 1229
Epoch: [46]  [10/47]  eta: 0:01:15  lr: 0.000040  loss: 0.5067 (0.5185)  time: 2.0350  data: 2.0016  max mem: 1229
Epoch: [46]  [20/47]  eta: 0:00:53  lr: 0.000040  loss: 0.5146 (0.5204)  time: 1.9917  data: 1.9583  max mem: 1229
Epoch: [46]  [30/47]  eta: 0:00:34  lr: 0.000040  loss: 0.5316 (0.5202)  time: 1.9974  data: 1.9639  max mem: 1229
Epoch: [46]  [40/47]  eta: 0:00:13  lr: 0.000040  loss: 0.5342 (0.5214)  time: 1.9728  data: 1.9393  max mem: 1229
Epoch: [46]  [46/47]  eta: 0:00:01  lr: 0.000040  loss: 0.4920 (0.5189)  time: 1.9134  data: 1.8803  max mem: 1229
Epoch: [46] Total time: 0:01:32 (1.9757 s / it)
Averaged stats: lr: 0.000040  loss: 0.4920 (0.5189)
/home/qingchan/project/deit_smh/deit_smh/engine.py:137: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast():
Test:  [ 0/14]  eta: 0:00:55  loss: 0.2159 (0.2159)  acc1: 97.9167 (97.9167)  acc5: 100.0000 (100.0000)  time: 3.9516  data: 3.9379  max mem: 1229
Test:  [10/14]  eta: 0:00:15  loss: 0.2181 (0.2261)  acc1: 95.8333 (95.6439)  acc5: 100.0000 (100.0000)  time: 3.9897  data: 3.9766  max mem: 1229
Test:  [13/14]  eta: 0:00:03  loss: 0.2304 (0.2284)  acc1: 95.8333 (95.5350)  acc5: 100.0000 (100.0000)  time: 3.8208  data: 3.8082  max mem: 1229
Test: Total time: 0:00:53 (3.8210 s / it)
* Acc@1 95.535 Acc@5 100.000 loss 0.228
Accuracy of the network on the 1299 test images: 95.5%
Max accuracy: 96.30%
/home/qingchan/project/deit_smh/deit_smh/engine.py:86: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast():
Epoch: [47]  [ 0/47]  eta: 0:01:54  lr: 0.000040  loss: 0.4149 (0.4149)  time: 2.4322  data: 2.3997  max mem: 1229
Epoch: [47]  [10/47]  eta: 0:01:17  lr: 0.000040  loss: 0.6002 (0.5705)  time: 2.0920  data: 2.0584  max mem: 1229
Epoch: [47]  [20/47]  eta: 0:00:55  lr: 0.000040  loss: 0.5787 (0.5602)  time: 2.0408  data: 2.0074  max mem: 1229
Epoch: [47]  [30/47]  eta: 0:00:34  lr: 0.000040  loss: 0.5520 (0.5496)  time: 1.9953  data: 1.9620  max mem: 1229
Epoch: [47]  [40/47]  eta: 0:00:14  lr: 0.000040  loss: 0.5456 (0.5381)  time: 1.9870  data: 1.9534  max mem: 1229
Epoch: [47]  [46/47]  eta: 0:00:01  lr: 0.000040  loss: 0.5131 (0.5341)  time: 1.9284  data: 1.8948  max mem: 1229
Epoch: [47] Total time: 0:01:33 (1.9922 s / it)
Averaged stats: lr: 0.000040  loss: 0.5131 (0.5341)
/home/qingchan/project/deit_smh/deit_smh/engine.py:137: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast():
Test:  [ 0/14]  eta: 0:00:51  loss: 0.2235 (0.2235)  acc1: 93.7500 (93.7500)  acc5: 100.0000 (100.0000)  time: 3.7064  data: 3.6933  max mem: 1229
Test:  [10/14]  eta: 0:00:15  loss: 0.2235 (0.2242)  acc1: 94.7917 (95.2652)  acc5: 100.0000 (100.0000)  time: 3.9621  data: 3.9490  max mem: 1229
Test:  [13/14]  eta: 0:00:03  loss: 0.2235 (0.2252)  acc1: 94.7917 (95.3041)  acc5: 100.0000 (100.0000)  time: 3.7992  data: 3.7866  max mem: 1229
Test: Total time: 0:00:53 (3.7993 s / it)
* Acc@1 95.304 Acc@5 100.000 loss 0.225
Accuracy of the network on the 1299 test images: 95.3%
Max accuracy: 96.30%
/home/qingchan/project/deit_smh/deit_smh/engine.py:86: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast():
Epoch: [48]  [ 0/47]  eta: 0:01:42  lr: 0.000039  loss: 0.5108 (0.5108)  time: 2.1807  data: 2.1486  max mem: 1229
Epoch: [48]  [10/47]  eta: 0:01:12  lr: 0.000039  loss: 0.5063 (0.4966)  time: 1.9638  data: 1.9305  max mem: 1229
Epoch: [48]  [20/47]  eta: 0:00:53  lr: 0.000039  loss: 0.4934 (0.5120)  time: 1.9709  data: 1.9379  max mem: 1229
Epoch: [48]  [30/47]  eta: 0:00:33  lr: 0.000039  loss: 0.4934 (0.5073)  time: 1.9887  data: 1.9558  max mem: 1229
Epoch: [48]  [40/47]  eta: 0:00:13  lr: 0.000039  loss: 0.5126 (0.5174)  time: 1.9710  data: 1.9380  max mem: 1229
Epoch: [48]  [46/47]  eta: 0:00:01  lr: 0.000039  loss: 0.5191 (0.5159)  time: 1.9739  data: 1.9407  max mem: 1229
Epoch: [48] Total time: 0:01:33 (1.9789 s / it)
Averaged stats: lr: 0.000039  loss: 0.5191 (0.5159)
/home/qingchan/project/deit_smh/deit_smh/engine.py:137: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast():
Test:  [ 0/14]  eta: 0:00:51  loss: 0.2043 (0.2043)  acc1: 95.8333 (95.8333)  acc5: 100.0000 (100.0000)  time: 3.6470  data: 3.6339  max mem: 1229
Test:  [10/14]  eta: 0:00:16  loss: 0.2047 (0.2132)  acc1: 95.8333 (95.6439)  acc5: 100.0000 (100.0000)  time: 4.0803  data: 4.0671  max mem: 1229
Test:  [13/14]  eta: 0:00:03  loss: 0.2135 (0.2149)  acc1: 95.8333 (95.6890)  acc5: 100.0000 (100.0000)  time: 3.8880  data: 3.8753  max mem: 1229
Test: Total time: 0:00:54 (3.8881 s / it)
* Acc@1 95.689 Acc@5 100.000 loss 0.215
Accuracy of the network on the 1299 test images: 95.7%
Max accuracy: 96.30%
/home/qingchan/project/deit_smh/deit_smh/engine.py:86: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast():
Epoch: [49]  [ 0/47]  eta: 0:01:28  lr: 0.000038  loss: 0.6308 (0.6308)  time: 1.8828  data: 1.8508  max mem: 1229
Epoch: [49]  [10/47]  eta: 0:01:08  lr: 0.000038  loss: 0.5261 (0.5314)  time: 1.8513  data: 1.8180  max mem: 1229
Epoch: [49]  [20/47]  eta: 0:00:52  lr: 0.000038  loss: 0.5134 (0.5266)  time: 1.9663  data: 1.9330  max mem: 1229
Epoch: [49]  [30/47]  eta: 0:00:33  lr: 0.000038  loss: 0.5348 (0.5339)  time: 2.0680  data: 2.0345  max mem: 1229
Epoch: [49]  [40/47]  eta: 0:00:14  lr: 0.000038  loss: 0.5582 (0.5449)  time: 2.0500  data: 2.0166  max mem: 1229
Epoch: [49]  [46/47]  eta: 0:00:01  lr: 0.000038  loss: 0.5567 (0.5457)  time: 2.0270  data: 1.9935  max mem: 1229
Epoch: [49] Total time: 0:01:33 (1.9981 s / it)
Averaged stats: lr: 0.000038  loss: 0.5567 (0.5457)
/home/qingchan/project/deit_smh/deit_smh/engine.py:137: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast():
Test:  [ 0/14]  eta: 0:00:50  loss: 0.2333 (0.2333)  acc1: 94.7917 (94.7917)  acc5: 100.0000 (100.0000)  time: 3.6391  data: 3.6260  max mem: 1229
Test:  [10/14]  eta: 0:00:15  loss: 0.2333 (0.2373)  acc1: 96.8750 (96.4015)  acc5: 100.0000 (100.0000)  time: 3.9541  data: 3.9410  max mem: 1229
Test:  [13/14]  eta: 0:00:03  loss: 0.2333 (0.2384)  acc1: 96.8750 (96.3818)  acc5: 100.0000 (100.0000)  time: 3.7859  data: 3.7733  max mem: 1229
Test: Total time: 0:00:53 (3.7860 s / it)
* Acc@1 96.382 Acc@5 100.000 loss 0.238
Accuracy of the network on the 1299 test images: 96.4%
Max accuracy: 96.38%
/home/qingchan/project/deit_smh/deit_smh/engine.py:86: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast():
Epoch: [50]  [ 0/47]  eta: 0:01:25  lr: 0.000037  loss: 0.4625 (0.4625)  time: 1.8205  data: 1.7882  max mem: 1229
Epoch: [50]  [10/47]  eta: 0:01:12  lr: 0.000037  loss: 0.5796 (0.5538)  time: 1.9725  data: 1.9389  max mem: 1229
Epoch: [50]  [20/47]  eta: 0:00:54  lr: 0.000037  loss: 0.5565 (0.5363)  time: 2.0302  data: 1.9963  max mem: 1229
